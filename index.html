<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>High Resolution Time</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 3c53a5b02, updated Thu Nov 27 17:03:30 2025 +0000" name="generator">
  <link href="https://www.w3.org/TR/hr-time-3/" rel="canonical">
  <meta content="7e17bd9e4d07ef94294424fe52ca206aee6e80aa" name="revision">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>
.note:not(.no-marker)::before {
  content: "Note";
}
</style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example " counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-idl-highlighting */
pre.idl.highlight {
    background: var(--borderedblock-bg, var(--def-bg));
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-var-click-highlighting */
/*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

[data-algorithm] var { cursor: pointer; }
var[data-var-color] { background-color: var(--var-bg); box-shadow: 0 0 0 2px var(--var-bg); }

var[data-var-color] { --var-bg: #F4D200; }
var[data-var-color="1"] { --var-bg: #FF87A2; }
var[data-var-color="2"] { --var-bg: #96E885; }
var[data-var-color="3"] { --var-bg: #3EEED2; }
var[data-var-color="4"] { --var-bg: #EACFB6; }
var[data-var-color="5"] { --var-bg: #82DDFF; }
var[data-var-color="6"] { --var-vg: #FFBCF2; }

@media (prefers-color-scheme: dark) {
	var[data-var-color] { --var-bg: #bc1a00; }
	var[data-var-color="1"] { --var-bg: #007f00; }
	var[data-var-color="2"] { --var-bg: #008698; }
	var[data-var-color="3"] { --var-bg: #7f5b2b; }
	var[data-var-color="4"] { --var-bg: #004df3; }
	var[data-var-color="5"] { --var-bg: #a1248a; }
	var[data-var-color="6"] { --var-vg: #ff0000; }
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
</a>
</p>
   <h1 class="no-ref p-name" id="title">High Resolution Time</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types/#ED">Editor’s Draft</a>,
    <time class="dt-updated" datetime="2026-02-25">25 February 2026</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://w3c.github.io/hr-time/">https://w3c.github.io/hr-time/</a>
      <dt>Latest published version:
      <dd><a href="https://www.w3.org/TR/hr-time-3/">https://www.w3.org/TR/hr-time-3/</a>
      <dt>Feedback:
      <dd><span><a href="mailto:public-web-perf@w3.org?subject=%5Bhr-time-3%5D%20YOUR%20TOPIC%20HERE">public-web-perf@w3.org</a> with subject line “<kbd>[hr-time-3] <i data-lt>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-web-perf/" rel="discussion">archives</a>)</span>
      <dd><a href="https://github.com/w3c/hr-time/issues/">GitHub</a>
      <dd><a href="#issues-index">Inline In Spec</a>
      <dt>Test Suite:
      <dd><a href="https://wpt.live/hr-time/">https://wpt.live/hr-time/</a>
      <dt class="editor">Editor:
      <dd class="editor h-card p-author vcard" data-editor-id="58673"><a class="fn p-name u-url url" href="https://blog.yoav.ws/">Yoav Weiss</a> (<a class="org p-org" href="https://shopify.com/">Shopify</a>)
      <dt class="editor">Former Editors:
      <dd class="editor h-card p-author vcard" data-editor-id="56102"><a class="email fn p-name u-email" href="mailto:igrigorik@gmail.com">Ilya Grigorik</a> (<a class="org p-org" href="https://google.com/">Google LLC</a>)
      <dd class="editor h-card p-author vcard" data-editor-id="45726"><a class="email fn p-name u-email" href="mailto:simonjam@google.com">James Simonsen</a> (<a class="org p-org" href="https://google.com/">Google LLC</a>)
      <dd class="editor h-card p-author vcard" data-editor-id="44357"><a class="email fn p-name u-email" href="mailto:jmann@microsoft.com">Jatinder Mann</a> (<a class="org p-org" href="https://microsoft.com/">Microsoft Corp.</a>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2026 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply.
</p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="heading no-num no-ref no-toc settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification defines an API that provides the time origin, and current time in sub-millisecond resolution, such that it is not subject to system clock skew or adjustments.</p>
  </div>
  <h2 class="heading no-num no-ref no-toc settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p>
	This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress.

</p>
   <p><a href="https://github.com/w3c/hr-time/issues">GitHub Issues</a> are preferred for discussion of this specification.

</p>
   <p>This document is governed by the
	<a href="https://www.w3.org/policies/process/20250818/" id="w3c_process_revision">18 August 2025 W3C Process Document</a>.

</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-ref no-toc" id="contents">Table of Contents</h2>
   <ol class="toc">
    <li>
     <a href="#introduction"><span class="secno">1</span> <span class="content">
  Introduction
</span></a>
     <ol class="toc">
      <li><a href="#use-cases"><span class="secno">1.1</span> <span class="content">
  Use-cases
</span></a>
      <li><a href="#examples"><span class="secno">1.2</span> <span class="content">
  Examples
</span></a>
     </ol>
    <li>
     <a href="#sec-concepts"><span class="secno">2</span> <span class="content">
  Time Concepts
</span></a>
     <ol class="toc">
      <li><a href="#sec-clocks"><span class="secno">2.1</span> <span class="content">
  Clocks
</span></a>
      <li><a href="#sec-moments-and-durations"><span class="secno">2.2</span> <span class="content">
  Moments and Durations
</span></a>
     </ol>
    <li>
     <a href="#sec-tools"><span class="secno">3</span> <span class="content">
  Tools for Specification Authors
</span></a>
     <ol class="toc">
      <li><a href="#sec-tools-examples"><span class="secno">3.1</span> <span class="content">
  Examples
</span></a>
     </ol>
    <li><a href="#sec-time-origin"><span class="secno">4</span> <span class="content">
  Time Origin
</span></a>
    <li><a href="#sec-domhighrestimestamp"><span class="secno">5</span> <span class="content">
  The <span>DOMHighResTimeStamp</span> typedef
</span></a>
    <li><a href="#sec-epochtimestamp"><span class="secno">6</span> <span class="content">
  The <span>EpochTimeStamp</span> typedef
</span></a>
    <li>
     <a href="#sec-performance"><span class="secno">7</span> <span class="content">
  The <span>Performance</span> interface
</span></a>
     <ol class="toc">
      <li><a href="#now-method"><span class="secno">7.1</span> <span class="content">
  <code>now()</code> method
</span></a>
      <li><a href="#timeorigin-attribute"><span class="secno">7.2</span> <span class="content">
  <code>timeOrigin</code> attribute
</span></a>
      <li><a href="#tojson-method"><span class="secno">7.3</span> <span class="content">
  <code>toJSON()</code> method
</span></a>
     </ol>
    <li>
     <a href="#sec-windoworworkerglobalscope"><span class="secno">8</span> <span class="content">
  Extensions to <code>WindowOrWorkerGlobalScope</code> mixin
</span></a>
     <ol class="toc">
      <li><a href="#the-performance-attribute"><span class="secno">8.1</span> <span class="content">
  The <code>performance</code> attribute
</span></a>
     </ol>
    <li>
     <a href="#sec-security"><span class="secno">9</span> <span class="content">
  Security Considerations
</span></a>
     <ol class="toc">
      <li><a href="#clock-resolution"><span class="secno">9.1</span> <span class="content">
  Clock resolution
</span></a>
      <li><a href="#clock-drift"><span class="secno">9.2</span> <span class="content">
  Clock drift
</span></a>
     </ol>
    <li><a href="#sec-privacy"><span class="secno">10</span> <span class="content">
  Privacy Considerations
</span></a>
    <li><a href="#acknowledgments"><span class="secno">11</span> <span class="content">
  Acknowledgments
</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading informative settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">
  Introduction
</span><a class="self-link" href="#introduction"></a></h2>
   
<em>This section is non-normative.</em>

   <p>
  The ECMAScript Language specification <a data-link-type="biblio" href="#biblio-ecma-262" title="ECMAScript Language Specification">[ECMA-262]</a> defines the
  <code><a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-date-objects">Date</a></code> object as a time value
  representing time in milliseconds since 01 January, 1970 UTC. For most
  purposes, this definition of time is sufficient as these values
  represent time to millisecond precision for any moment that is within
  approximately 285,616 years from 01 January, 1970 UTC.
</p>
   <p>
  In practice, these definitions of time are subject to both clock skew
  and adjustment of the system clock. The value of time may not always be
  monotonically increasing and subsequent values may either decrease or
  remain the same.
</p>
   <p>
  For example, the following script may record a positive number,
  negative number, or zero for computed <code>duration</code>:
</p>
<pre class="example highlight" id="example-date-now"><a class="self-link" href="#example-date-now"></a><c- a>var</c-> mark_start <c- o>=</c-> Date<c- p>.</c->now<c- p>();</c->
doTask<c- p>();</c-> <c- c1>// Some task</c->
<c- a>var</c-> duration <c- o>=</c-> Date<c- p>.</c->now<c- p>()</c-> <c- o>-</c-> mark_start<c- p>;</c->
</pre>
   <p>
  For certain tasks this definition of time may not be sufficient as it:
</p>
   <ul>
    <li>Does not have a stable monotonic clock, and as a result, it is
  subject to system clock skew.
  
    <li>Does not provide sub-millisecond time resolution.
  
   </ul>
   <p>
  This specification does not propose changing the behavior of
  <code><a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-date.now">Date.now()</a></code> <a data-link-type="biblio" href="#biblio-ecma-262" title="ECMAScript Language Specification">[ECMA-262]</a> as it is
  genuinely useful in determining the current value of the calendar time
  and has a long history of usage. The <code class="idl"><a data-link-type="idl" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp">DOMHighResTimeStamp</a></code> type,
  <code class="idl"><a data-link-type="idl" href="#performance" id="ref-for-performance">Performance</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-performance-now" id="ref-for-dom-performance-now">now()</a></code> method, and
  <code class="idl"><a data-link-type="idl" href="#performance" id="ref-for-performance①">Performance</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-performance-timeorigin" id="ref-for-dom-performance-timeorigin">timeOrigin</a></code> attributes of the
  <code class="idl"><a data-link-type="idl" href="#performance" id="ref-for-performance②">Performance</a></code> interface resolve the above issues by providing
  monotonically increasing time values with sub-millisecond resolution.
</p>
   <p class="note" role="note">
  <span class="allow-2119">
  Providing sub-millisecond resolution is not a mandatory part of this
  specification. Implementations may choose to limit the timer resolution
  they expose for privacy and security reasons, and not expose
  sub-millisecond timers. Use-cases that rely on sub-millisecond
  resolution may not be satisfied when that happens.
  </span>
</p>
   <h3 class="heading informative settled" data-level="1.1" id="use-cases"><span class="secno">1.1. </span><span class="content">
  Use-cases
</span><a class="self-link" href="#use-cases"></a></h3>
   
<em>This section is non-normative.</em>

   <p>
  This specification defines a few different capabilities: it provides
  timestamps based on a stable, monotonic clock, comparable across
  contexts, with potential sub-millisecond resolution.
</p>
   <p>
  The need for a stable monotonic clock when talking about performance
  measurements stems from the fact that unrelated clock skew can
  distort measurements and render them useless. For example, when
  attempting to accurately measure the elapsed time of navigating to a
  Document, fetching of resources or execution of script, a
  monotonically increasing clock with sub-millisecond resolution is
  desired.
</p>
   <p>
  Comparing timestamps between contexts is essential e.g. when
  synchronizing work between a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker">Worker</a></code> and the main thread or when
  instrumenting such work in order to create a unified view of the
  event timeline.
</p>
   <p>
  Finally, the need for sub-millisecond timers revolves around the
  following use-cases:
</p>
   <ul>
    <li>Ability to schedule work in sub-millisecond intervals. That is
  particularly important on the main thread, where work can interfere
  with frame rendering which needs to happen in short and regular
  intervals, to avoid user-visible jank.
  
    <li>When calculating the frame rate of a script-based animation,
  developers will need sub-millisecond resolution in order to determine
  if an animation is drawing at 60 FPS. Without sub-millisecond
  resolution, a developer can only determine if an animation is drawing
  at 58.8 FPS (1000ms / 16) or 62.5 FPS (1000ms / 17).
  
    <li>When collecting in-the-wild measurements of JS code (e.g. using
  User-Timing), developers may be interested in gathering
  sub-milliseconds timing of their functions, to catch regressions
  early.
  
    <li>When attempting to cue audio to a specific point in an animation
  or ensure that the audio and animation are perfectly synchronized,
  developers will need to accurately measure the amount of time
  elapsed.
  
   </ul>
   <h3 class="heading informative settled" data-level="1.2" id="examples"><span class="secno">1.2. </span><span class="content">
  Examples
</span><a class="self-link" href="#examples"></a></h3>
   
<em>This section is non-normative.</em>

   <p>
  A developer may wish to construct a timeline of their entire
  application, including events from <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker①">Worker</a></code> or <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworker" id="ref-for-sharedworker">SharedWorker</a></code>,
  which have different <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin">time origins</a>. To
  display such events on the same timeline, the application can
  translate the <code class="idl"><a data-link-type="idl" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp①">DOMHighResTimeStamp</a></code>s with the help of the
  <code class="idl"><a data-link-type="idl" href="#performance" id="ref-for-performance③">Performance</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-performance-timeorigin" id="ref-for-dom-performance-timeorigin①">timeOrigin</a></code> attribute.
</p>
<pre class="example highlight" id="example-worker-timeline"><a class="self-link" href="#example-worker-timeline"></a><c- c1>// ---- worker.js -----------------------------</c->
<c- c1>// Shared worker script</c->
onconnect <c- o>=</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c->
  <c- a>var</c-> port <c- o>=</c-> e<c- p>.</c->ports<c- p>[</c-><c- mf>0</c-><c- p>];</c->
  port<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c->
    <c- c1>// Time execution in worker</c->
    <c- a>var</c-> task_start <c- o>=</c-> performance<c- p>.</c->now<c- p>();</c->
    result <c- o>=</c-> runSomeWorkerTask<c- p>();</c->
    <c- a>var</c-> task_end <c- o>=</c-> performance<c- p>.</c->now<c- p>();</c->
  <c- p>}</c->

  <c- c1>// Send results and epoch-relative timestamps to another context</c->
  port<c- p>.</c->postMessage<c- p>({</c->
    <c- t>'task'</c-><c- o>:</c-> <c- t>'Some worker task'</c-><c- p>,</c->
    <c- t>'start_time'</c-><c- o>:</c-> task_start <c- o>+</c-> performance<c- p>.</c->timeOrigin<c- p>,</c->
    <c- t>'end_time'</c-><c- o>:</c-> task_end <c- o>+</c-> performance<c- p>.</c->timeOrigin<c- p>,</c->
    <c- t>'result'</c-><c- o>:</c-> result
  <c- p>});</c->
<c- p>}</c->

<c- c1>// ---- application.js ------------------------</c->
<c- c1>// Timing tasks in the document</c->
<c- a>var</c-> task_start <c- o>=</c-> performance<c- p>.</c->now<c- p>();</c->
runSomeApplicationTask<c- p>();</c->
<c- a>var</c-> task_end <c- o>=</c-> performance<c- p>.</c->now<c- p>();</c->

<c- c1>// developer provided method to upload runtime performance data</c->
reportEventToAnalytics<c- p>({</c->
  <c- t>'task'</c-><c- o>:</c-> <c- t>'Some document task'</c-><c- p>,</c->
  <c- t>'start_time'</c-><c- o>:</c-> task_start<c- p>,</c->
  <c- t>'duration'</c-><c- o>:</c-> task_end <c- o>-</c-> task_start
<c- p>});</c->

<c- c1>// Translating worker timestamps into document’s time origin</c->
<c- a>var</c-> worker <c- o>=</c-> <c- ow>new</c-> SharedWorker<c- p>(</c-><c- t>'worker.js'</c-><c- p>);</c->
worker<c- p>.</c->port<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
  <c- a>var</c-> msg <c- o>=</c-> event<c- p>.</c->data<c- p>;</c->

  <c- c1>// translate epoch-relative timestamps into document’s time origin</c->
  msg<c- p>.</c->start_time <c- o>=</c-> msg<c- p>.</c->start_time <c- o>-</c-> performance<c- p>.</c->timeOrigin<c- p>;</c->
  msg<c- p>.</c->end_time <c- o>=</c-> msg<c- p>.</c->end_time <c- o>-</c-> performance<c- p>.</c->timeOrigin<c- p>;</c->

  reportEventToAnalytics<c- p>(</c->msg<c- p>);</c->
<c- p>}</c->
</pre>
   <h2 class="heading settled" data-level="2" id="sec-concepts"><span class="secno">2. </span><span class="content">
  Time Concepts
</span><a class="self-link" href="#sec-concepts"></a></h2>
   <h3 class="heading settled" data-level="2.1" id="sec-clocks"><span class="secno">2.1. </span><span class="content">
  Clocks
</span><a class="self-link" href="#sec-clocks"></a></h3>
   <p>
  A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="clock">clock</dfn> tracks the passage of time and can report the
  <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="unsafe-current-time">unsafe current time</dfn> that an algorithm step is executing.
  There are many kinds of clocks. All clocks on the web platform
  attempt to count 1 millisecond of clock time per 1 millisecond of
  real-world time, but they differ in how they handle cases where they
  can’t be exactly correct.
</p>
   <div>
    <dl>
     <dt data-md>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="wall-clock">wall clock</dfn>’s <dfn class="dfn-paneled" data-dfn-for="wall clock" data-dfn-type="dfn" data-export id="wall-clock-unsafe-current-time">unsafe current time</dfn>
     <dd data-md>
      <p>is always as close as possible to a user’s notion of time. Since a computer sometimes runs slow or fast or loses track of time, its <a data-link-type="dfn" href="#wall-clock" id="ref-for-wall-clock">wall clock</a> sometimes needs to be adjusted, which means the <a data-link-type="dfn" href="#wall-clock-unsafe-current-time" id="ref-for-wall-clock-unsafe-current-time">unsafe current time</a> can decrease, making it unreliable for performance measurement or recording the orders of events. The web platform shares a <a data-link-type="dfn" href="#wall-clock" id="ref-for-wall-clock①">wall clock</a> with <a data-link-type="biblio" href="#biblio-ecma-262" title="ECMAScript Language Specification">[ECMA-262]</a> <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-time-values-and-time-range">time</a>.</p>
     <dt data-md>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="monotonic-clock">monotonic clock</dfn>’s <dfn class="dfn-paneled" data-dfn-for="monotonic clock" data-dfn-type="dfn" data-export id="monotonic-clock-unsafe-current-time">unsafe current time</dfn>
     <dd data-md>
      <p>never decreases, so it can’t be changed by system clock adjustments. The <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock">monotonic clock</a> only exists within a single execution of the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent">user agent</a>, so it can’t be used to compare events that might happen in different executions.</p>
    </dl>
   </div>
   <p class="note" role="note"><span class="allow-2119">Since the <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock①">monotonic clock</a> can’t be adjusted to match the user’s notion of time, it should be used for measurement, rather than user-visible times. For any time communication with the user, use the wall clock.</span></p>
   <p class="note" role="note"><span class="allow-2119">The user agent can pick a new <a data-link-type="dfn" href="#estimated-monotonic-time-of-the-unix-epoch" id="ref-for-estimated-monotonic-time-of-the-unix-epoch">estimated monotonic time of the Unix epoch</a> when the browser restarts, when it starts an isolated browsing session—e.g. incognito or a similar browsing mode—or when it creates an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a> that can’t communicate with any existing settings objects. As a result, developers should not use shared timestamps as absolute time that holds its monotonic properties across all past, present, and future contexts; in practice, the monotonic properties only apply for contexts that can reach each other by exchanging messages via one of the provided messaging mechanisms - e.g. <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#dom-window-postmessage-options" id="ref-for-dom-window-postmessage-options">postMessage(message, options)</a></code>, <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#broadcastchannel" id="ref-for-broadcastchannel">BroadcastChannel</a></code>, etc.</span></p>
   <p class="note" role="note"><span class="allow-2119">In certain scenarios (e.g. when a tab is backgrounded), the user agent may choose to throttle timers and periodic callbacks run in that context or even freeze them entirely. Any such throttling should not affect the resolution or accuracy of the time returned by the monotonic clock.</span></p>
   <h3 class="heading settled" data-level="2.2" id="sec-moments-and-durations"><span class="secno">2.2. </span><span class="content">
  Moments and Durations
</span><a class="self-link" href="#sec-moments-and-durations"></a></h3>
   <p>
  Each <a data-link-type="dfn" href="#clock" id="ref-for-clock">clock</a>’s <a href="#unsafe-current-time" id="ref-for-unsafe-current-time">unsafe current time</a> returns an <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="unsafe moment" data-noexport id="unsafe-moment">unsafe
  moment</dfn>. <a data-link-type="dfn" href="#coarsen-time" id="ref-for-coarsen-time">Coarsen time</a> converts these <a data-link-type="dfn" href="#unsafe-moment" id="ref-for-unsafe-moment">unsafe moments</a> to
  <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="moment" id="moment">coarsened moments</dfn> or just
  <a data-link-type="dfn" href="#moment" id="ref-for-moment">moments</a>. <a data-link-type="dfn" href="#unsafe-moment" id="ref-for-unsafe-moment①">Unsafe moments</a> and <a data-link-type="dfn" href="#moment" id="ref-for-moment①">moments</a> from different clocks
  are not comparable.
</p>
   <p class="note" role="note">
  <a data-link-type="dfn" href="#moment" id="ref-for-moment②">Moments</a> and <a data-link-type="dfn" href="#unsafe-moment" id="ref-for-unsafe-moment②">unsafe moments</a> represent points in time, which
  means they can’t be directly stored as numbers. Implementations will
  usually represent a <a data-link-type="dfn" href="#moment" id="ref-for-moment③">moment</a> as a <a data-link-type="dfn" href="#duration" id="ref-for-duration">duration</a> from some other
  fixed point in time, but specifications ought to deal in the
  <a data-link-type="dfn" href="#moment" id="ref-for-moment④">moments</a> themselves.
</p>
   <p>
  A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="duration">duration</dfn> is the distance from one
  <a data-link-type="dfn" href="#moment" id="ref-for-moment⑤">moment</a> to another from the same <a data-link-type="dfn" href="#clock" id="ref-for-clock①">clock</a>. Neither endpoint can
  be an <a data-link-type="dfn" href="#unsafe-moment" id="ref-for-unsafe-moment③">unsafe moment</a> so that both <a data-link-type="dfn" href="#duration" id="ref-for-duration①">durations</a> and differences of
  <a data-link-type="dfn" href="#duration" id="ref-for-duration②">durations</a> mitigate the concerns in [<a href="#clock-resolution">§ 9.1 Clock resolution</a>].
  <a data-link-type="dfn" href="#duration" id="ref-for-duration③">Durations</a> are measured in milliseconds, seconds, etc. Since all
  <a data-link-type="dfn" href="#clock" id="ref-for-clock②">clocks</a> attempt to count at the same rate, <a data-link-type="dfn" href="#duration" id="ref-for-duration④">durations</a> don’t
  have an associated <a data-link-type="dfn" href="#clock" id="ref-for-clock③">clock</a>, and a <a data-link-type="dfn" href="#duration" id="ref-for-duration⑤">duration</a> calculated from two
  <a data-link-type="dfn" href="#moment" id="ref-for-moment⑥">moments</a> on one clock can be added to a <a data-link-type="dfn" href="#moment" id="ref-for-moment⑦">moment</a> from a second
  <a data-link-type="dfn" href="#clock" id="ref-for-clock④">clock</a>, to produce another <a data-link-type="dfn" href="#moment" id="ref-for-moment⑧">moment</a> on that second <a data-link-type="dfn" href="#clock" id="ref-for-clock⑤">clock</a>.
</p>
   <p>
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="duration-from">duration from</dfn> <var>a</var> to <var>b</var>
  is the result of the following algorithm:
</p>
   <ol class="algorithm">
    <li>Assert: <var>a</var> was created by the same <a data-link-type="dfn" href="#clock" id="ref-for-clock⑥">clock</a> as <var>b</var>.
  
    <li>Assert: Both <var>a</var> and <var>b</var> are <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-moment" id="ref-for-dfn-moment">coarsened moments</a>.
  
    <li>Return the amount of time from <var>a</var> to <var>b</var> as a <a data-link-type="dfn" href="#duration" id="ref-for-duration⑥">duration</a>. If
  <var>b</var> came before <var>a</var>, this will be a negative <a data-link-type="dfn" href="#duration" id="ref-for-duration⑦">duration</a>.
  
   </ol>
   <p>
  <a data-link-type="dfn" href="#duration" id="ref-for-duration⑧">Durations</a> can be used implicitly as <code class="idl"><a data-link-type="idl" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp②">DOMHighResTimeStamp</a></code>s. To
  <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="implicitly-convert-a-duration-to-a-timestamp">implicitly convert a duration to a timestamp</dfn>, given a
  <a data-link-type="dfn" href="#duration" id="ref-for-duration⑨">duration</a> <var>d</var>, return the number of milliseconds in <var>d</var>.
</p>
   <h2 class="heading settled" data-level="3" id="sec-tools"><span class="secno">3. </span><span class="content">
  Tools for Specification Authors
</span><a class="self-link" href="#sec-tools"></a></h2>
   <p>
  For measuring time within a single page (within the context of a single
  <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①">environment settings object</a>), use the <var>settingsObject</var>’s <dfn class="dfn-paneled" data-dfn-for="environment settings object" data-dfn-type="dfn" data-export id="environment-settings-object-current-relative-timestamp">current relative timestamp</dfn>, defined
  as the <a data-link-type="dfn" href="#duration-from" id="ref-for-duration-from">duration from</a> <var>settingsObject</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin①">time origin</a> to the <var>settingsObject</var>’s <a data-link-type="dfn" href="#environment-settings-object-current-monotonic-time" id="ref-for-environment-settings-object-current-monotonic-time">current monotonic time</a>. This value can be exposed directly to
  JavaScript using the <a data-link-type="dfn" href="#duration" id="ref-for-duration①⓪">duration</a>’s <a data-link-type="dfn" href="#implicitly-convert-a-duration-to-a-timestamp" id="ref-for-implicitly-convert-a-duration-to-a-timestamp">implicit conversion</a> to <code class="idl"><a data-link-type="idl" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp③">DOMHighResTimeStamp</a></code>.
</p>
   <p>
  For measuring time within a single UA execution when an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object②">environment settings object</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin②">time origin</a> isn’t
  an appropriate base for comparison, create <a data-link-type="dfn" href="#moment" id="ref-for-moment⑨">moments</a> using an
  <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object③">environment settings object</a>’s <a data-link-type="dfn" href="#environment-settings-object-current-monotonic-time" id="ref-for-environment-settings-object-current-monotonic-time①">current monotonic time</a>. An <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object④">environment settings object</a>
  <var>settingsObject</var>’s <dfn class="dfn-paneled" data-dfn-for="environment settings object" data-dfn-type="dfn" data-export id="environment-settings-object-current-monotonic-time">current monotonic time</dfn>
  is the result of the following steps:
</p>
   <ol>
    <li>Let <var>unsafeMonotonicTime</var> be
  the <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock②">monotonic clock</a>’s <a data-link-type="dfn" href="#monotonic-clock-unsafe-current-time" id="ref-for-monotonic-clock-unsafe-current-time">unsafe current time</a>.
  
    <li>Return the result of calling <a data-link-type="dfn" href="#coarsen-time" id="ref-for-coarsen-time①">coarsen time</a> with
  <var>unsafeMonotonicTime</var> and <var>settingsObject</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability" id="ref-for-concept-settings-object-cross-origin-isolated-capability">cross-origin isolated capability</a>.
  
   </ol>
   <p>
  <a data-link-type="dfn" href="#moment" id="ref-for-moment①⓪">Moments</a> from the <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock③">monotonic clock</a> can’t be directly represented
  in JavaScript or HTTP. Instead, expose a <a data-link-type="dfn" href="#duration" id="ref-for-duration①①">duration</a> between two such
  <a data-link-type="dfn" href="#moment" id="ref-for-moment①①">moments</a>.
</p>
   <p>
  For measuring time across multiple UA executions, create <a data-link-type="dfn" href="#moment" id="ref-for-moment①②">moments</a>
  using the <a data-link-type="dfn" href="#dfn-current-wall-time" id="ref-for-dfn-current-wall-time">current coarsened wall time</a> or (if you need higher
  precision in <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability" id="ref-for-concept-settings-object-cross-origin-isolated-capability①">cross-origin-isolated contexts</a>) an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑤">environment settings object</a>’s <a data-link-type="dfn" href="#dfn-eso-current-wall-time" id="ref-for-dfn-eso-current-wall-time">current wall time</a>. The
  <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="current coarsened wall time" id="dfn-current-wall-time">current coarsened wall
  time</dfn> is the result of calling <a data-link-type="dfn" href="#coarsen-time" id="ref-for-coarsen-time②">coarsen time</a> with the <a data-link-type="dfn" href="#wall-clock" id="ref-for-wall-clock②">wall clock</a>’s <a data-link-type="dfn" href="#wall-clock-unsafe-current-time" id="ref-for-wall-clock-unsafe-current-time①">unsafe current time</a>.
</p>
   <p>
  An <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑥">environment settings object</a> <var>settingsObject</var>’s <dfn class="dfn-paneled" data-dfn-for="environment settings object" data-dfn-type="dfn" data-export data-lt="current wall time" id="dfn-eso-current-wall-time">current
  wall time</dfn> is the result of the following steps:
</p>
   <ol>
    <li>Let <var>unsafeWallTime</var> be the <a data-link-type="dfn" href="#wall-clock" id="ref-for-wall-clock③">wall clock</a>’s <a data-link-type="dfn" href="#wall-clock-unsafe-current-time" id="ref-for-wall-clock-unsafe-current-time②">unsafe current time</a>.
  
    <li>Return the result of calling <a data-link-type="dfn" href="#coarsen-time" id="ref-for-coarsen-time③">coarsen time</a> with <var>unsafeWallTime</var>
  and <var>settingsObject</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability" id="ref-for-concept-settings-object-cross-origin-isolated-capability②">cross-origin isolated capability</a>.
  
   </ol>
   <p class="advisement">
  When using <a data-link-type="dfn" href="#moment" id="ref-for-moment①③">moments</a> from the <a data-link-type="dfn" href="#wall-clock" id="ref-for-wall-clock④">wall clock</a>, be sure that your
  design accounts for situations when the user adjusts their clock either
  forward or backward.
</p>
   <p>
  <a data-link-type="dfn" href="#moment" id="ref-for-moment①④">Moments</a> from the <a data-link-type="dfn" href="#wall-clock" id="ref-for-wall-clock⑤">wall clock</a> can be represented in JavaScript by
  passing the number of milliseconds from the <a data-link-type="dfn" href="#unix-epoch" id="ref-for-unix-epoch">Unix epoch</a> to that
  <a data-link-type="dfn" href="#moment" id="ref-for-moment①⑤">moment</a> into the <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/multipage/numbers-and-dates.html#sec-date-objects" id="ref-for-sec-date-objects">Date</a></code> constructor, or by passing the number of
  nanoseconds from the <a data-link-type="dfn" href="#unix-epoch" id="ref-for-unix-epoch①">Unix epoch</a> to that <a data-link-type="dfn" href="#moment" id="ref-for-moment①⑥">moment</a> into the
  <a class="idl-code" data-link-type="interface" href="https://tc39.es/proposal-temporal/#sec-temporal-instant-constructor">Temporal.Instant</a>
  constructor. <a data-link-type="biblio" href="#biblio-temporal" title="Temporal">[Temporal]</a>
</p>
   <p class="advisement tracking-vector">
  Avoid sending similar representations between computers, as doing so
  will expose the user’s clock skew, which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#tracking-vector" id="ref-for-tracking-vector">tracking vector</a>.
  Instead, use an approach similar to <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock④">monotonic clock</a> <a data-link-type="dfn" href="#moment" id="ref-for-moment①⑦">moments</a> of
  sending a duration between two <a data-link-type="dfn" href="#moment" id="ref-for-moment①⑧">moments</a>.
</p>
   <h3 class="heading settled" data-level="3.1" id="sec-tools-examples"><span class="secno">3.1. </span><span class="content">
  Examples
</span><a class="self-link" href="#sec-tools-examples"></a></h3>
   <div class="example" id="example-current-relative-timestamp">
    <a class="self-link" href="#example-current-relative-timestamp"></a>
  
    <p>
    The time a DOM event happens can be reported using:
  </p>
    <ol start="7">
     <li>Initialize <var>event</var>’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-timestamp" id="ref-for-dom-event-timestamp">timeStamp</a></code> attribute to
    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings object</a>’s <a data-link-type="dfn" href="#environment-settings-object-current-relative-timestamp" id="ref-for-environment-settings-object-current-relative-timestamp">current relative timestamp</a>.
    
    </ol>
   </div>
   <div class="example" id="example-current-monotonic-time">
    <a class="self-link" href="#example-current-monotonic-time"></a>
  
    <p>
    The age of an error report can be computed using:
  </p>
    <ol start="7">
     <li>Initialize <var>report</var>’s <a href="https://www.w3.org/TR/reporting/#report-timestamp">generation time</a> to <var>settings</var>’
    <a data-link-type="dfn" href="#environment-settings-object-current-monotonic-time" id="ref-for-environment-settings-object-current-monotonic-time②">current monotonic time</a>.
    
    </ol>
    <p>
    Later:
  </p>
    <ol start="2">
     <li>
      Let <var>data</var> be a map with the following key/value pairs:
      
      <dl>
       <dt>
          age
        
       <dd>
          The number of milliseconds between <var>report</var>’s <a href="https://www.w3.org/TR/reporting/#report-timestamp">generation time</a> and
          <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①">relevant settings object</a>’s <a data-link-type="dfn" href="#environment-settings-object-current-monotonic-time" id="ref-for-environment-settings-object-current-monotonic-time③">current monotonic time</a>, rounded to the
          nearest integer.
        
       <dd>
          ...
        
      </dl>
    </ol>
   </div>
   <div class="example" id="example-current-wall-time">
    <a class="self-link" href="#example-current-wall-time"></a>
  
    <p>
    Multi-day attribution report expirations can be handled as:
  </p>
    <ol start="2">
     <li>
      Let <var>source</var> be a new attribution source struct whose items
    are:
      
      <dl>
       <dt>
          ...
        
       <dt>
          source time
        
       <dd>
          <var>context</var>’s <a data-link-type="dfn" href="#dfn-eso-current-wall-time" id="ref-for-dfn-eso-current-wall-time①">current wall time</a>
        
       <dt>
          expiry
        
       <dd>
          <a href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#parse-a-duration-string">parse a duration
          string</a> from <code><var>value</var>["expiry"]</code>
        
      </dl>
    </ol>
    <p>
    Days later:
  </p>
    <ol start="2">
     <li>If <var>context</var>’s <a data-link-type="dfn" href="#dfn-eso-current-wall-time" id="ref-for-dfn-eso-current-wall-time②">current wall time</a> is less than <var>source</var>’s source time + <var>source</var>’s expiry,
    send a report.
    
    </ol>
   </div>
   <h2 class="heading settled" data-level="4" id="sec-time-origin"><span class="secno">4. </span><span class="content">
  Time Origin
</span><a class="self-link" href="#sec-time-origin"></a></h2>
   <p>
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="unix-epoch">Unix epoch</dfn> is the <a data-link-type="dfn" href="#moment" id="ref-for-moment①⑨">moment</a> on the
  <a data-link-type="dfn" href="#wall-clock" id="ref-for-wall-clock⑥">wall clock</a> corresponding to 1 January 1970 00:00:00 UTC.
</p>
   <p>
  Each group of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑦">environment settings objects</a> that could possibly
  communicate in any way has an <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="estimated monotonic time of the Unix epoch" data-noexport id="estimated-monotonic-time-of-the-unix-epoch">estimated monotonic time of the Unix
  epoch</dfn>, a <a data-link-type="dfn" href="#moment" id="ref-for-moment②⓪">moment</a> on the <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock⑤">monotonic clock</a>, whose value is
  initialized by the following steps:
</p>
   <ol class="algorithm" data-algorithm="initialize the estimated monotonic time of the Unix epoch">
    <li>Let <var>wall time</var> be the <a data-link-type="dfn" href="#wall-clock" id="ref-for-wall-clock⑦">wall clock</a>’s <a data-link-type="dfn" href="#wall-clock-unsafe-current-time" id="ref-for-wall-clock-unsafe-current-time③">unsafe current time</a>.
  
    <li>Let <var>monotonic time</var> be the
  <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock⑥">monotonic clock</a>’s <a data-link-type="dfn" href="#monotonic-clock-unsafe-current-time" id="ref-for-monotonic-clock-unsafe-current-time①">unsafe current time</a>.
  
    <li>Let <var>epoch time</var> be
  <code><var>monotonic time</var> - (<var>wall time</var> - <a data-link-type="dfn" href="#unix-epoch" id="ref-for-unix-epoch②">Unix epoch</a>)</code>
  
    <li>Initialize the <a data-link-type="dfn" href="#estimated-monotonic-time-of-the-unix-epoch" id="ref-for-estimated-monotonic-time-of-the-unix-epoch①">estimated monotonic time of the Unix epoch</a> to
  the result of calling <a data-link-type="dfn" href="#coarsen-time" id="ref-for-coarsen-time④">coarsen time</a> with <var>epoch time</var>.
  
   </ol>
   <div class="issue" id="issue-51f20fed"><a class="self-link" href="#issue-51f20fed"></a>
  The above set of settings-objects-that-could-possibly-communicate needs
  to be specified better. It’s similar to <a href="https://html.spec.whatwg.org/multipage/browsers.html#familiar-with">familiar with</a> but includes
  <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker②">Worker</a></code>s.
</div>
   <p>
  Performance measurements report a <a data-link-type="dfn" href="#duration" id="ref-for-duration①②">duration</a> from a <a data-link-type="dfn" href="#moment" id="ref-for-moment②①">moment</a> early
  in the initialization of a relevant <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object⑧">environment settings object</a>.
  That <a data-link-type="dfn" href="#moment" id="ref-for-moment②②">moment</a> is stored in that settings object’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin③">time origin</a>.
</p>
   <p>
  To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="get-time-origin-timestamp">get time origin timestamp</dfn>, given a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object">global object</a>
  <var>global</var>, run the following steps, which return a
  <a data-link-type="dfn" href="#duration" id="ref-for-duration①③">duration</a>:
</p>
   <ol>
    <li>
     <p>
      Let <var>timeOrigin</var> be <var>global</var>’s
      <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object②">relevant settings object</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin④">time origin</a>.
    </p>
     <p class="note" role="note">
      In <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window">Window</a></code> contexts, this value represents the time when
      <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate">navigation has started</a>. In <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker③">Worker</a></code> and
      <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#serviceworker" id="ref-for-serviceworker">ServiceWorker</a></code> contents, this value represent the time when the
      <a href="https://html.spec.whatwg.org/multipage/webappapis.html#run-a-worker">worker is run</a>. <a data-link-type="biblio" href="#biblio-service-workers" title="Service Workers Nightly">[SERVICE-WORKERS]</a>
    </p>
    <li>Return the <a data-link-type="dfn" href="#duration-from" id="ref-for-duration-from①">duration from</a> the <a data-link-type="dfn" href="#estimated-monotonic-time-of-the-unix-epoch" id="ref-for-estimated-monotonic-time-of-the-unix-epoch②">estimated monotonic time of the Unix epoch</a> to <var>timeOrigin</var>.
  
   </ol>
   <p class="note" role="note">
  <span class="allow-2119">
  The value returned by <a data-link-type="dfn" href="#get-time-origin-timestamp" id="ref-for-get-time-origin-timestamp">get time origin timestamp</a> is approximately
  the time after the <a data-link-type="dfn" href="#unix-epoch" id="ref-for-unix-epoch③">Unix epoch</a> that <var>global</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin⑤">time origin</a> happened. It may differ from the value
  returned by <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-date.now">Date.now()</a> executed at the time origin, because the
  former is recorded with respect to a <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock⑦">monotonic clock</a> that is not
  subject to system and user clock adjustments, clock skew, and so on.
  </span>
</p>
   <div class="algorithm" data-algorithm="coarsen time">
    
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="coarsen-time">coarsen time</dfn> algorithm, given an <a data-link-type="dfn" href="#unsafe-moment" id="ref-for-unsafe-moment④">unsafe moment</a> <var>timestamp</var> on some <a data-link-type="dfn" href="#clock" id="ref-for-clock⑦">clock</a> and an optional
  boolean <var>crossOriginIsolatedCapability</var> (default false), runs
  the following steps:
  
    <ol>
     <li>Let <var>time resolution</var> be 100 microseconds, or a higher
    <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined">implementation-defined</a> value.
    
     <li>If <var>crossOriginIsolatedCapability</var> is true, set <var>time resolution</var>
    to be 5 microseconds, or a higher <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined①">implementation-defined</a>
    value.
    
     <li>In an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined②">implementation-defined</a> manner, coarsen and
    potentially jitter <var>timestamp</var> such that its resolution will not
    exceed <var>time resolution</var>.
    
     <li>Return <var>timestamp</var> as a <a data-link-type="dfn" href="#moment" id="ref-for-moment②③">moment</a>.
    
    </ol>
   </div>
   <div class="algorithm" data-algorithm="relative high resolution time">
    
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="relative-high-resolution-time">relative high resolution time</dfn> given an
  <a data-link-type="dfn" href="#unsafe-moment" id="ref-for-unsafe-moment⑤">unsafe moment</a> from the <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock⑧">monotonic clock</a> <var>time</var>
  and a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object①">global object</a> <var>global</var>, is the <a data-link-type="dfn" href="#duration" id="ref-for-duration①④">duration</a> returned from the following steps:
  
    <ol>
     <li>Let <var>coarse time</var> be the result of
    calling <a data-link-type="dfn" href="#coarsen-time" id="ref-for-coarsen-time⑤">coarsen time</a> with <var>time</var> and <var>global</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object③">relevant settings object</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability" id="ref-for-concept-settings-object-cross-origin-isolated-capability③">cross-origin isolated capability</a>.
    
     <li>Return the <a data-link-type="dfn" href="#relative-high-resolution-coarse-time" id="ref-for-relative-high-resolution-coarse-time">relative high resolution coarse time</a> for <var>coarse
    time</var> and <var>global</var>.
    
    </ol>
    The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="relative-high-resolution-coarse-time">relative high resolution coarse time</dfn>
  given a <a data-link-type="dfn" href="#moment" id="ref-for-moment②④">moment</a> from the <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock⑨">monotonic clock</a> <var>coarseTime</var>
  and a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object②">global object</a> <var>global</var>, is the <a data-link-type="dfn" href="#duration-from" id="ref-for-duration-from②">duration from</a> <var>global</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object④">relevant settings object</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin⑥">time origin</a> to <var>coarseTime</var>.

   </div>
   <p>
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="current-high-resolution-time">current high resolution time</dfn> given a
  <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object③">global object</a> <var>current global</var> must return the
  result of <a data-link-type="dfn" href="#relative-high-resolution-time" id="ref-for-relative-high-resolution-time">relative high resolution time</a> given <a data-link-type="dfn" href="#unsafe-shared-current-time" id="ref-for-unsafe-shared-current-time">unsafe shared current time</a> and <var>current global</var>.
</p>
   <p>
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="coarsened-shared-current-time">coarsened shared current time</dfn> given an
  optional boolean <var>crossOriginIsolatedCapability</var> (default
  false), must return the result of calling <a data-link-type="dfn" href="#coarsen-time" id="ref-for-coarsen-time⑥">coarsen time</a> with the
  <a data-link-type="dfn" href="#unsafe-shared-current-time" id="ref-for-unsafe-shared-current-time①">unsafe shared current time</a> and <var>crossOriginIsolatedCapability</var>.
</p>
   <p>
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="unsafe-shared-current-time">unsafe shared current time</dfn> must return
  the <a data-link-type="dfn" href="#monotonic-clock-unsafe-current-time" id="ref-for-monotonic-clock-unsafe-current-time②">unsafe current time</a> of the <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock①⓪">monotonic clock</a>.
</p>
   <h2 class="heading settled" data-level="5" id="sec-domhighrestimestamp"><span class="secno">5. </span><span class="content">
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="domhighrestimestamp">DOMHighResTimeStamp</dfn> typedef
</span><a class="self-link" href="#sec-domhighrestimestamp"></a></h2>
   <p>
  The <code class="idl"><a data-link-type="idl" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp④">DOMHighResTimeStamp</a></code> type is used to store a <a data-link-type="dfn" href="#duration" id="ref-for-duration①⑤">duration</a> in
  milliseconds. Depending on its context, it may represent the <a data-link-type="dfn" href="#moment" id="ref-for-moment②⑤">moment</a>
  that is this <a data-link-type="dfn" href="#duration" id="ref-for-duration①⑥">duration</a> after a base <a data-link-type="dfn" href="#moment" id="ref-for-moment②⑥">moment</a> like a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin⑦">time origin</a> or the <a data-link-type="dfn" href="#unix-epoch" id="ref-for-unix-epoch④">Unix epoch</a>.
</p>
<pre class="def highlight idl"><c- b>typedef</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double" id="ref-for-idl-double"><c- b>double</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-domhighrestimestamp"><code><c- g>DOMHighResTimeStamp</c-></code></dfn>;
</pre>
   <p>
  A <code class="idl"><a data-link-type="idl" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp⑤">DOMHighResTimeStamp</a></code> SHOULD represent a time in milliseconds
  accurate enough to allow measurement while preventing timing attacks -
  see <a href="#clock-resolution">§ 9.1 Clock resolution</a> for additional considerations.
</p>
   <p class="note" role="note">
  A <code class="idl"><a data-link-type="idl" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp⑥">DOMHighResTimeStamp</a></code> is a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-double" id="ref-for-idl-double①">double</a></code>, so it can only represent an
  epoch-relative time—the number of milliseconds from the <a data-link-type="dfn" href="#unix-epoch" id="ref-for-unix-epoch⑤">Unix epoch</a>
  to a <a data-link-type="dfn" href="#moment" id="ref-for-moment②⑦">moment</a>—to a finite resolution. For <a data-link-type="dfn" href="#moment" id="ref-for-moment②⑧">moments</a> in 2023, that
  resolution is approximately 0.2 microseconds.
</p>
   <h2 class="heading settled" data-level="6" id="sec-epochtimestamp"><span class="secno">6. </span><span class="content">
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="epochtimestamp">EpochTimeStamp</dfn> typedef
</span><a class="self-link" href="#sec-epochtimestamp"></a></h2>
<pre class="def highlight idl"><c- b>typedef</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-epochtimestamp"><code><c- g>EpochTimeStamp</c-></code></dfn>;
</pre>
   <aside class="note" title="Legacy platform feature">
    <p>
    The use of `EpochTimeStamp`, known previously as `DOMTimeStamp`, is
    discouraged. Wherever possible use <code class="idl"><a data-link-type="idl" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp⑦">DOMHighResTimeStamp</a></code> instead.
  </p>
   </aside>
   <p>
  A <code class="idl"><a data-link-type="idl" href="#typedefdef-epochtimestamp" id="ref-for-typedefdef-epochtimestamp">EpochTimeStamp</a></code> represents an integral number of milliseconds from
  the <a data-link-type="dfn" href="#unix-epoch" id="ref-for-unix-epoch⑥">Unix epoch</a> to a given <a data-link-type="dfn" href="#moment" id="ref-for-moment②⑨">moment</a> on the <a data-link-type="dfn" href="#wall-clock" id="ref-for-wall-clock⑧">wall clock</a>,
  excluding leap seconds. Specifications that use this type define how
  the number of milliseconds are interpreted.
</p>
   <h2 class="heading settled" data-dfn-for="Performance" data-level="7" id="sec-performance"><span class="secno">7. </span><span class="content">
  The <dfn class="dfn-paneled" data-dfn-for="Performance" data-dfn-type="dfn" data-export id="performance-performance">Performance</dfn> interface
</span><a class="self-link" href="#sec-performance"></a></h2>
<pre class="def highlight idl">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="performance"><code><c- g>Performance</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget"><c- n>EventTarget</c-></a> {
    <a data-link-type="idl-name" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp⑧"><c- n>DOMHighResTimeStamp</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="Performance" data-dfn-type="method" data-export data-lt="now()" id="dom-performance-now"><code><c- g>now</c-></code></dfn>();
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp⑨"><c- n>DOMHighResTimeStamp</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="Performance" data-dfn-type="attribute" data-export data-readonly data-type="DOMHighResTimeStamp" id="dom-performance-timeorigin"><code><c- g>timeOrigin</c-></code></dfn>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Default" id="ref-for-Default"><c- g>Default</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object"><c- b>object</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="Performance" data-dfn-type="method" data-export data-lt="toJSON()" id="dom-performance-tojson"><code><c- g>toJSON</c-></code></dfn>();
};
</pre>
   <h3 class="heading settled" data-level="7.1" id="now-method"><span class="secno">7.1. </span><span class="content">
  <code>now()</code> method
</span><a class="self-link" href="#now-method"></a></h3>
   <p data-tests="basic.any.html, basic.any.worker.html">
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="now">now()</dfn> method MUST return the number of milliseconds in
  the <a data-link-type="dfn" href="#current-high-resolution-time" id="ref-for-current-high-resolution-time">current high resolution time</a> given <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①">this</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a> (a <a data-link-type="dfn" href="#duration" id="ref-for-duration①⑦">duration</a>).
</p>
   <p data-tests="monotonic-clock.any.html, monotonic-clock.any.worker.html">
  The time values returned when calling the <code class="idl"><a data-link-type="idl" href="#dom-performance-now" id="ref-for-dom-performance-now①">now()</a></code>
  method on <code class="idl"><a data-link-type="idl" href="#performance" id="ref-for-performance④">Performance</a></code> objects with the same <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin⑧">time origin</a> MUST use the same <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock①①">monotonic clock</a>.
  The difference between any two chronologically recorded time values
  returned from the <code class="idl"><a data-link-type="idl" href="#dom-performance-now" id="ref-for-dom-performance-now②">now()</a></code> method MUST never be negative
  if the two time values have the same <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin⑨">time origin</a>.
</p>
   <h3 class="heading settled" data-level="7.2" id="timeorigin-attribute"><span class="secno">7.2. </span><span class="content">
  <code>timeOrigin</code> attribute
</span><a class="self-link" href="#timeorigin-attribute"></a></h3>
   <p data-tests="timeOrigin.html, window-worker-timeOrigin.window.html">
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="timeorigin">timeOrigin</dfn> attribute MUST return the number of
  milliseconds in the <a data-link-type="dfn" href="#duration" id="ref-for-duration①⑧">duration</a> returned by <a data-link-type="dfn" href="#get-time-origin-timestamp" id="ref-for-get-time-origin-timestamp①">get time origin timestamp</a> for the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global①">relevant global object</a> of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②">this</a>.
</p>
   <p data-tests="test_cross_frame_start.html">
  The time values returned when getting
  <code class="idl"><a data-link-type="idl" href="#performance" id="ref-for-performance⑤">Performance</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-performance-timeorigin" id="ref-for-dom-performance-timeorigin②">timeOrigin</a></code> MUST use the same
  <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock①②">monotonic clock</a> that is shared by <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin①⓪">time origins</a>, and whose reference point is the <a data-link-type="biblio" href="#biblio-ecma-262" title="ECMAScript Language Specification">[ECMA-262]</a>
  <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-time-values-and-time-range">time</a>
  definition - see [<a href="#sec-security">§ 9 Security Considerations</a>].
</p>
   <h3 class="heading settled" data-level="7.3" id="tojson-method"><span class="secno">7.3. </span><span class="content">
  <code>toJSON()</code> method
</span><a class="self-link" href="#tojson-method"></a></h3>
   <p data-tests="performance-tojson.html">
  When <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="tojson">toJSON()</dfn> is called, run <a data-link-type="biblio" href="#biblio-webidl" title="Web IDL Standard">[WEBIDL]</a>’s <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#default-tojson-steps" id="ref-for-default-tojson-steps">default toJSON steps</a>.
</p>
   <h2 class="heading settled" data-level="8" id="sec-windoworworkerglobalscope"><span class="secno">8. </span><span class="content">
  Extensions to <code>WindowOrWorkerGlobalScope</code> mixin
</span><a class="self-link" href="#sec-windoworworkerglobalscope"></a></h2>
   <h3 class="heading settled" data-dfn-for="WindowOrWorkerGlobalScope" data-level="8.1" id="the-performance-attribute"><span class="secno">8.1. </span><span class="content">
  The <code>performance</code> attribute
</span><a class="self-link" href="#the-performance-attribute"></a></h3>
   <p>
  The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="the-performance-attr">performance</dfn> attribute on the interface mixin
  <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope">WindowOrWorkerGlobalScope</a></code> allows access to performance related
  attributes and methods from the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object④">global object</a>.
</p>
<pre class="def highlight idl"><c- b>partial</c-> <c- b>interface</c-> <c- b>mixin</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope①"><c- g>WindowOrWorkerGlobalScope</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Replaceable" id="ref-for-Replaceable"><c- g>Replaceable</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#performance" id="ref-for-performance⑥"><c- n>Performance</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WindowOrWorkerGlobalScope" data-dfn-type="attribute" data-export data-readonly data-type="Performance" id="dom-windoworworkerglobalscope-performance"><code><c- g>performance</c-></code></dfn>;
};
</pre>
   <h2 class="heading informative settled" data-level="9" id="sec-security"><span class="secno">9. </span><span class="content">
  Security Considerations
</span><a class="self-link" href="#sec-security"></a></h2>
   
<em>This section is non-normative.</em>


   <h3 class="heading settled" data-level="9.1" id="clock-resolution"><span class="secno">9.1. </span><span class="content">
  Clock resolution
</span><a class="self-link" href="#clock-resolution"></a></h3>
   <p>
  Access to accurate timing information, both for measurement and
  scheduling purposes, is a common requirement for many applications.
  For example, coordinating animations, sound, and other activity on
  the page requires access to high-resolution time to provide a good
  user experience. Similarly, measurement enables developers to track
  the performance of critical code components, detect regressions, and
  so on.
</p>
   <p>
  However, access to the same accurate timing information can sometimes
  be also used for malicious purposes by an attacker to guess and infer
  data that they can’t see or access otherwise. For example, cache
  attacks, statistical fingerprinting and micro-architectural attacks
  are a privacy and security concern where a malicious web site may use
  high resolution timing data of various browser or
  application-initiated operations to differentiate between subset of
  users, identify a particular user or reveal unrelated but
  same-process user data - see <a data-link-type="biblio" href="#biblio-cache-attacks" title="The Spy in the Sandbox - Practical Cache Attacks in Javascript">[CACHE-ATTACKS]</a> and <a data-link-type="biblio" href="#biblio-spectre" title="Spectre Attacks: Exploiting Speculative Execution">[SPECTRE]</a> for
  more background.
</p>
   <p data-tests="timing-attack.html">
  This specification defines an API that provides sub-millisecond time
  resolution, which is more accurate than the previously available
  millisecond resolution exposed by <code class="idl"><a data-link-type="idl" href="#typedefdef-epochtimestamp" id="ref-for-typedefdef-epochtimestamp①">EpochTimeStamp</a></code>. However, even
  without this new API an attacker may be able to obtain
  high-resolution estimates through repeat execution and statistical
  analysis.
</p>
   <p>
  To ensure that the new API does not significantly improve the
  accuracy or speed of such attacks, the minimum resolution of the
  <code class="idl"><a data-link-type="idl" href="#typedefdef-domhighrestimestamp" id="ref-for-typedefdef-domhighrestimestamp①⓪">DOMHighResTimeStamp</a></code> type should be inaccurate enough to prevent
  attacks.
</p>
   <p>
  Where necessary, the user agent should set higher resolution values
  to <var>time resolution</var> in <a data-link-type="dfn" href="#coarsen-time" id="ref-for-coarsen-time⑦">coarsen time</a>’s processing model, to
  address privacy and security concerns due to architecture or software
  constraints, or other considerations.
</p>
   <p>
  In order to mitigate such attacks user agents may deploy any
  technique they deem necessary. Deployment of those techniques may
  vary based on the browser’s architecture, the user’s device, the
  content and its ability to maliciously read cross-origin data, or
  other practical considerations.
</p>
   <p>
  <span class="allow-2119">These techniques may include:</span>
</p>
   <ul>
    <li>Resolution reduction.
  
    <li>Added jitter.
  
    <li>Abuse detection and/or API call throttling.
  
   </ul>
   <p>
  Mitigating such timing side-channel attacks entirely is practically
  impossible: either all operations would have to execute in a time
  that does not vary based on the value of any confidential
  information, or the application would need to be isolated from any
  time-related primitives (clock, timers, counters, etc). Neither is
  practical due to the associated complexity for the browser and
  application developers and the associated negative effects on
  performance and responsiveness of applications.
</p>
   <div class="note" role="note">
  Clock resolution is an unsolved and evolving area of research, with
  no existing industry consensus or definitive set of recommendations
  that applies to all browsers. To track the discussion, refer to
  <a href="https://github.com/w3c/hr-time/issues/79">Issue 79</a>.
</div>
   <h3 class="heading settled" data-level="9.2" id="clock-drift"><span class="secno">9.2. </span><span class="content">
  Clock drift
</span><a class="self-link" href="#clock-drift"></a></h3>
   <p>
  This specification also defines an API that provides sub-millisecond
  time resolution of the zero time of the time origin, which requires
  and exposes a <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock①③">monotonic clock</a> to the application, and that
  must be shared across all the browser contexts. The <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock①④">monotonic clock</a> does not need to be tied to physical time, but is
  recommended to be set with respect to the <a data-link-type="biblio" href="#biblio-ecma-262" title="ECMAScript Language Specification">[ECMA-262]</a> definition of
  <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-time-values-and-time-range">time</a> to avoid exposing new fingerprint entropy about the user
  — e.g. this time can already be easily obtained by the application,
  whereas exposing a new logical clock provides new information.
</p>
   <p>
  However, even with the above mechanism in place, the <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock①⑤">monotonic clock</a> may provide additional <a href="https://en.wikipedia.org/wiki/Clock_drift">clock drift</a>
  resolution. Today, the application can timestamp the time-of-day and
  monotonic time values (via <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-date.now">Date.now()</a> and
  <code class="idl"><a data-link-type="idl" href="#dom-performance-now" id="ref-for-dom-performance-now③">now()</a></code>) at multiple points within the same context and
  observe drift between them—e.g. due to automatic or user clock
  adjustments. With the <code class="idl"><a data-link-type="idl" href="#dom-performance-timeorigin" id="ref-for-dom-performance-timeorigin③">timeOrigin</a></code> attribute, the
  attacker can also compare the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin①①">time origin</a>, as reported by the <a data-link-type="dfn" href="#monotonic-clock" id="ref-for-monotonic-clock①⑥">monotonic clock</a>, against the
  current time-of-day estimate of the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin①②">time origin</a> (i.e. the difference between
  `performance.timeOrigin` and `Date.now() - performance.now()`) and
  potentially observe clock drift between these clocks over a longer
  time period.
</p>
   <p>
  In practice, the same time drift can be observed by an application
  across multiple navigations: the application can record the logical
  time in each context and use a client or server time synchronization
  mechanism to infer changes in the user’s clock. Similarly,
  lower-layer mechanisms such as TCP timestamps may reveal the same
  high-resolution information to the server without the need for
  multiple visits. As such, the information provided by this API should
  not expose any significant or previously unavailable entropy about
  the user.
</p>
   <h2 class="heading informative settled" data-level="10" id="sec-privacy"><span class="secno">10. </span><span class="content">
  Privacy Considerations
</span><a class="self-link" href="#sec-privacy"></a></h2>
   
<em>This section is non-normative.</em>

   <p>
  The current definition of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin" id="ref-for-concept-settings-object-time-origin①③">time origin</a>
  for a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> exposes the total time of cross-origin redirects
  prior to the request arriving at the document’s origin. This exposes
  cross-origin information, however it’s not yet decided how to mitigate
  this without causing major breakages to performance metrics.
</p>
   <p>
  To track the discussion, refer to <a href="https://github.com/w3c/navigation-timing/issues/160">Navigation Timing
  Issue 160</a>.
</p>
   <h2 class="appendix heading informative settled" data-level="11" id="acknowledgments"><span class="secno">11. </span><span class="content">
  Acknowledgments
</span><a class="self-link" href="#acknowledgments"></a></h2>
   <p>
  Thanks to Arvind Jain, Angelos D. Keromytis, Boris Zbarsky, Jason
  Weber, Karen Anderson, Nat Duca, Philippe Le Hegaret, Ryosuke Niwa,
  Simha Sethumadhavan, Todd Reifsteck, Tony Gentilcore, Vasileios P.
  Kemerlis, Yoav Weiss, and Yossef Oren for their contributions to this
  work.
</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="heading no-num no-ref settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="heading no-num no-ref settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification.

    </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a>

    </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this:

    </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a>
        
    <p>This is an example of an informative example.
    </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this:

    </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <section>
    <h3 class="heading no-num no-ref settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
    <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm.

    </p>
    <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize.
</p>
   </section>
  </div>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="heading no-num no-ref settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="heading no-num no-ref settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#clock">clock</a><span>, in § 2.1</span>
   <li><a href="#coarsened-shared-current-time">coarsened shared current time</a><span>, in § 4</span>
   <li><a href="#coarsen-time">coarsen time</a><span>, in § 4</span>
   <li><a href="#dfn-current-wall-time">current coarsened wall time</a><span>, in § 3</span>
   <li><a href="#current-high-resolution-time">current high resolution time</a><span>, in § 4</span>
   <li><a href="#environment-settings-object-current-monotonic-time">current monotonic time</a><span>, in § 3</span>
   <li><a href="#environment-settings-object-current-relative-timestamp">current relative timestamp</a><span>, in § 3</span>
   <li><a href="#dfn-eso-current-wall-time">current wall time</a><span>, in § 3</span>
   <li>
    DOMHighResTimeStamp
    <ul>
     <li><a href="#typedefdef-domhighrestimestamp">(typedef)</a><span>, in § 5</span>
     <li><a href="#domhighrestimestamp">definition of</a><span>, in § 5</span>
    </ul>
   <li><a href="#duration">duration</a><span>, in § 2.2</span>
   <li><a href="#duration-from">duration from</a><span>, in § 2.2</span>
   <li>
    EpochTimeStamp
    <ul>
     <li><a href="#typedefdef-epochtimestamp">(typedef)</a><span>, in § 6</span>
     <li><a href="#epochtimestamp">definition of</a><span>, in § 6</span>
    </ul>
   <li><a href="#estimated-monotonic-time-of-the-unix-epoch">estimated monotonic time of the Unix epoch</a><span>, in § 4</span>
   <li><a href="#get-time-origin-timestamp">get time origin timestamp</a><span>, in § 4</span>
   <li><a href="#implicitly-convert-a-duration-to-a-timestamp">implicitly convert a duration to a timestamp</a><span>, in § 2.2</span>
   <li><a href="#moment">moment</a><span>, in § 2.2</span>
   <li><a href="#monotonic-clock">monotonic clock</a><span>, in § 2.1</span>
   <li>
    now()
    <ul>
     <li><a href="#now">definition of</a><span>, in § 7.1</span>
     <li><a href="#dom-performance-now">method for Performance</a><span>, in § 7</span>
    </ul>
   <li>
    Performance
    <ul>
     <li><a href="#performance">(interface)</a><span>, in § 7</span>
     <li><a href="#performance-performance">dfn for Performance</a><span>, in § 7</span>
    </ul>
   <li>
    performance
    <ul>
     <li><a href="#dom-windoworworkerglobalscope-performance">attribute for WindowOrWorkerGlobalScope</a><span>, in § 8.1</span>
     <li><a href="#the-performance-attr">definition of</a><span>, in § 8.1</span>
    </ul>
   <li><a href="#relative-high-resolution-coarse-time">relative high resolution coarse time</a><span>, in § 4</span>
   <li><a href="#relative-high-resolution-time">relative high resolution time</a><span>, in § 4</span>
   <li>
    timeOrigin
    <ul>
     <li><a href="#dom-performance-timeorigin">attribute for Performance</a><span>, in § 7</span>
     <li><a href="#timeorigin">definition of</a><span>, in § 7.2</span>
    </ul>
   <li>
    toJSON()
    <ul>
     <li><a href="#tojson">definition of</a><span>, in § 7.3</span>
     <li><a href="#dom-performance-tojson">method for Performance</a><span>, in § 7</span>
    </ul>
   <li><a href="#unix-epoch">Unix epoch</a><span>, in § 4</span>
   <li>
    unsafe current time
    <ul>
     <li><a href="#unsafe-current-time">definition of</a><span>, in § 2.1</span>
     <li><a href="#monotonic-clock-unsafe-current-time">dfn for monotonic clock</a><span>, in § 2.1</span>
     <li><a href="#wall-clock-unsafe-current-time">dfn for wall clock</a><span>, in § 2.1</span>
    </ul>
   <li><a href="#unsafe-moment">unsafe moment</a><span>, in § 2.2</span>
   <li><a href="#unsafe-shared-current-time">unsafe shared current time</a><span>, in § 4</span>
   <li><a href="#wall-clock">wall clock</a><span>, in § 2.1</span>
  </ul>
  <h3 class="heading no-num no-ref settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="85394472">Document</span>
     <li><span class="dfn-paneled" id="2bc0cdf4">EventTarget</span>
     <li><span class="dfn-paneled" id="d4ec1548">timeStamp</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ECMA-262]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8c8cc336">Date</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HR-TIME-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="1d8f7431">coarsened moments</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a0c4f72a">BroadcastChannel</span>
     <li><span class="dfn-paneled" id="a13a702f">SharedWorker</span>
     <li><span class="dfn-paneled" id="5d7209e9">Window</span>
     <li><span class="dfn-paneled" id="5f6d392d">WindowOrWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="bfc1c271">Worker</span>
     <li><span class="dfn-paneled" id="473036cd">cross-origin isolated capability</span>
     <li><span class="dfn-paneled" id="3e12e042">environment settings object</span>
     <li><span class="dfn-paneled" id="4b6086d7">global object</span>
     <li><span class="dfn-paneled" id="8a7dfd23">postMessage(message, options)</span>
     <li><span class="dfn-paneled" id="e99bd18e">relevant global object</span>
     <li><span class="dfn-paneled" id="9c4c1e66">relevant settings object</span>
     <li><span class="dfn-paneled" id="e9c58cef">time origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="860300d4">implementation-defined</span>
     <li><span class="dfn-paneled" id="d7384c6e">tracking vector</span>
     <li><span class="dfn-paneled" id="6d19ac93">user agent</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SERVICE-WORKERS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="1968aaab">ServiceWorker</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f4531911">Default</span>
     <li><span class="dfn-paneled" id="889e932f">Exposed</span>
     <li><span class="dfn-paneled" id="01d5a451">Replaceable</span>
     <li><span class="dfn-paneled" id="dc7feabb">default toJSON steps</span>
     <li><span class="dfn-paneled" id="8c800cdf">double</span>
     <li><span class="dfn-paneled" id="efd1ec5d">object</span>
     <li><span class="dfn-paneled" id="4013a022">this</span>
     <li><span class="dfn-paneled" id="f14b47b8">unsigned long long</span>
    </ul>
  </ul>
  <h2 class="heading no-num no-ref settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="heading no-num no-ref settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-ecma-262">[ECMA-262]
   <dd><a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>. URL: <a href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
   <dt id="biblio-hr-time-3">[HR-TIME-3]
   <dd>Yoav Weiss. <a href="https://w3c.github.io/hr-time/"><cite>High Resolution Time</cite></a>. URL: <a href="https://w3c.github.io/hr-time/">https://w3c.github.io/hr-time/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="heading no-num no-ref settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-cache-attacks">[CACHE-ATTACKS]
   <dd>Yossef Oren; et al. <a href="https://arxiv.org/abs/1502.07373"><cite>The Spy in the Sandbox - Practical Cache Attacks in Javascript</cite></a>. 1 March 2015. URL: <a href="https://arxiv.org/abs/1502.07373">https://arxiv.org/abs/1502.07373</a>
   <dt id="biblio-service-workers">[SERVICE-WORKERS]
   <dd>Monica CHINTALA; Yoshisato Yanagisawa. <a href="https://w3c.github.io/ServiceWorker/"><cite>Service Workers Nightly</cite></a>. URL: <a href="https://w3c.github.io/ServiceWorker/">https://w3c.github.io/ServiceWorker/</a>
   <dt id="biblio-spectre">[SPECTRE]
   <dd>Paul Kocher; et al. <a href="https://spectreattack.com/spectre.pdf"><cite>Spectre Attacks: Exploiting Speculative Execution</cite></a>. January 2018. URL: <a href="https://spectreattack.com/spectre.pdf">https://spectreattack.com/spectre.pdf</a>
   <dt id="biblio-temporal">[Temporal]
   <dd><a href="https://tc39.es/proposal-temporal/"><cite>Temporal</cite></a>. Stage 3 Proposal. URL: <a href="https://tc39.es/proposal-temporal/">https://tc39.es/proposal-temporal/</a>
  </dl>
  <h2 class="heading no-num no-ref settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="def highlight idl"><c- b>typedef</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double"><c- b>double</c-></a> <a href="#typedefdef-domhighrestimestamp"><code><c- g>DOMHighResTimeStamp</c-></code></a>;

<c- b>typedef</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a href="#typedefdef-epochtimestamp"><code><c- g>EpochTimeStamp</c-></code></a>;

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#performance"><code><c- g>Performance</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
    <a data-link-type="idl-name" href="#typedefdef-domhighrestimestamp"><c- n>DOMHighResTimeStamp</c-></a> <a href="#dom-performance-now"><code><c- g>now</c-></code></a>();
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#typedefdef-domhighrestimestamp"><c- n>DOMHighResTimeStamp</c-></a> <a data-readonly data-type="DOMHighResTimeStamp" href="#dom-performance-timeorigin"><code><c- g>timeOrigin</c-></code></a>;
    [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Default"><c- g>Default</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a> <a href="#dom-performance-tojson"><code><c- g>toJSON</c-></code></a>();
};

<c- b>partial</c-> <c- b>interface</c-> <c- b>mixin</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope"><c- g>WindowOrWorkerGlobalScope</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Replaceable"><c- g>Replaceable</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#performance"><c- n>Performance</c-></a> <a data-readonly data-type="Performance" href="#dom-windoworworkerglobalscope-performance"><code><c- g>performance</c-></code></a>;
};

</pre>
  <h2 class="heading no-num no-ref settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue">
  The above set of settings-objects-that-could-possibly-communicate needs
  to be specified better. It’s similar to <a href="https://html.spec.whatwg.org/multipage/browsers.html#familiar-with">familiar with</a> but includes
  <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker">Worker</a></code>s.
 <a class="issue-return" href="#issue-51f20fed" title="Jump to section">↵</a></div>
  </div>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"01d5a451": {"dfnID":"01d5a451","dfnText":"Replaceable","external":true,"refSections":[{"refs":[{"id":"ref-for-Replaceable"}],"title":"8.1. \n  The performance attribute\n"}],"url":"https://webidl.spec.whatwg.org/#Replaceable"},
"1968aaab": {"dfnID":"1968aaab","dfnText":"ServiceWorker","external":true,"refSections":[{"refs":[{"id":"ref-for-serviceworker"}],"title":"4. \n  Time Origin\n"}],"url":"https://w3c.github.io/ServiceWorker/#serviceworker"},
"1d8f7431": {"dfnID":"1d8f7431","dfnText":"coarsened moments","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-moment"}],"title":"2.2. \n  Moments and Durations\n"}],"url":"https://w3c.github.io/hr-time/#dfn-moment"},
"2bc0cdf4": {"dfnID":"2bc0cdf4","dfnText":"EventTarget","external":true,"refSections":[{"refs":[{"id":"ref-for-eventtarget"}],"title":"7. \n  The Performance interface\n"}],"url":"https://dom.spec.whatwg.org/#eventtarget"},
"3e12e042": {"dfnID":"3e12e042","dfnText":"environment settings object","external":true,"refSections":[{"refs":[{"id":"ref-for-environment-settings-object"}],"title":"2.1. \n  Clocks\n"},{"refs":[{"id":"ref-for-environment-settings-object\u2460"},{"id":"ref-for-environment-settings-object\u2461"},{"id":"ref-for-environment-settings-object\u2462"},{"id":"ref-for-environment-settings-object\u2463"},{"id":"ref-for-environment-settings-object\u2464"},{"id":"ref-for-environment-settings-object\u2465"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-environment-settings-object\u2466"},{"id":"ref-for-environment-settings-object\u2467"}],"title":"4. \n  Time Origin\n"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"},
"4013a022": {"dfnID":"4013a022","dfnText":"this","external":true,"refSections":[{"refs":[{"id":"ref-for-this"}],"title":"3.1. \n  Examples\n"},{"refs":[{"id":"ref-for-this\u2460"}],"title":"7.1. \n  now() method\n"},{"refs":[{"id":"ref-for-this\u2461"}],"title":"7.2. \n  timeOrigin attribute\n"}],"url":"https://webidl.spec.whatwg.org/#this"},
"473036cd": {"dfnID":"473036cd","dfnText":"cross-origin isolated capability","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-settings-object-cross-origin-isolated-capability"},{"id":"ref-for-concept-settings-object-cross-origin-isolated-capability\u2460"},{"id":"ref-for-concept-settings-object-cross-origin-isolated-capability\u2461"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-concept-settings-object-cross-origin-isolated-capability\u2462"}],"title":"4. \n  Time Origin\n"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability"},
"4b6086d7": {"dfnID":"4b6086d7","dfnText":"global object","external":true,"refSections":[{"refs":[{"id":"ref-for-global-object"},{"id":"ref-for-global-object\u2460"},{"id":"ref-for-global-object\u2461"},{"id":"ref-for-global-object\u2462"}],"title":"4. \n  Time Origin\n"},{"refs":[{"id":"ref-for-global-object\u2463"}],"title":"8.1. \n  The performance attribute\n"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#global-object"},
"5d7209e9": {"dfnID":"5d7209e9","dfnText":"Window","external":true,"refSections":[{"refs":[{"id":"ref-for-window"}],"title":"4. \n  Time Origin\n"}],"url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"},
"5f6d392d": {"dfnID":"5f6d392d","dfnText":"WindowOrWorkerGlobalScope","external":true,"refSections":[{"refs":[{"id":"ref-for-windoworworkerglobalscope"},{"id":"ref-for-windoworworkerglobalscope\u2460"}],"title":"8.1. \n  The performance attribute\n"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope"},
"6d19ac93": {"dfnID":"6d19ac93","dfnText":"user agent","external":true,"refSections":[{"refs":[{"id":"ref-for-user-agent"}],"title":"2.1. \n  Clocks\n"}],"url":"https://infra.spec.whatwg.org/#user-agent"},
"85394472": {"dfnID":"85394472","dfnText":"Document","external":true,"refSections":[{"refs":[{"id":"ref-for-document"}],"title":"10. \n  Privacy Considerations\n"}],"url":"https://dom.spec.whatwg.org/#document"},
"860300d4": {"dfnID":"860300d4","dfnText":"implementation-defined","external":true,"refSections":[{"refs":[{"id":"ref-for-implementation-defined"},{"id":"ref-for-implementation-defined\u2460"},{"id":"ref-for-implementation-defined\u2461"}],"title":"4. \n  Time Origin\n"}],"url":"https://infra.spec.whatwg.org/#implementation-defined"},
"889e932f": {"dfnID":"889e932f","dfnText":"Exposed","external":true,"refSections":[{"refs":[{"id":"ref-for-Exposed"}],"title":"7. \n  The Performance interface\n"}],"url":"https://webidl.spec.whatwg.org/#Exposed"},
"8a7dfd23": {"dfnID":"8a7dfd23","dfnText":"postMessage(message, options)","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-window-postmessage-options"}],"title":"2.1. \n  Clocks\n"}],"url":"https://html.spec.whatwg.org/multipage/web-messaging.html#dom-window-postmessage-options"},
"8c800cdf": {"dfnID":"8c800cdf","dfnText":"double","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-double"},{"id":"ref-for-idl-double\u2460"}],"title":"5. \n  The DOMHighResTimeStamp typedef\n"}],"url":"https://webidl.spec.whatwg.org/#idl-double"},
"8c8cc336": {"dfnID":"8c8cc336","dfnText":"Date","external":true,"refSections":[{"refs":[{"id":"ref-for-sec-date-objects"}],"title":"3. \n  Tools for Specification Authors\n"}],"url":"https://tc39.es/ecma262/multipage/numbers-and-dates.html#sec-date-objects"},
"9c4c1e66": {"dfnID":"9c4c1e66","dfnText":"relevant settings object","external":true,"refSections":[{"refs":[{"id":"ref-for-relevant-settings-object"},{"id":"ref-for-relevant-settings-object\u2460"}],"title":"3.1. \n  Examples\n"},{"refs":[{"id":"ref-for-relevant-settings-object\u2461"},{"id":"ref-for-relevant-settings-object\u2462"},{"id":"ref-for-relevant-settings-object\u2463"}],"title":"4. \n  Time Origin\n"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"},
"a0c4f72a": {"dfnID":"a0c4f72a","dfnText":"BroadcastChannel","external":true,"refSections":[{"refs":[{"id":"ref-for-broadcastchannel"}],"title":"2.1. \n  Clocks\n"}],"url":"https://html.spec.whatwg.org/multipage/web-messaging.html#broadcastchannel"},
"a13a702f": {"dfnID":"a13a702f","dfnText":"SharedWorker","external":true,"refSections":[{"refs":[{"id":"ref-for-sharedworker"}],"title":"1.2. \n  Examples\n"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#sharedworker"},
"bfc1c271": {"dfnID":"bfc1c271","dfnText":"Worker","external":true,"refSections":[{"refs":[{"id":"ref-for-worker"}],"title":"1.1. \n  Use-cases\n"},{"refs":[{"id":"ref-for-worker\u2460"}],"title":"1.2. \n  Examples\n"},{"refs":[{"id":"ref-for-worker\u2461"},{"id":"ref-for-worker\u2462"}],"title":"4. \n  Time Origin\n"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#worker"},
"clock": {"dfnID":"clock","dfnText":"clock","external":false,"refSections":[{"refs":[{"id":"ref-for-clock"},{"id":"ref-for-clock\u2460"},{"id":"ref-for-clock\u2461"},{"id":"ref-for-clock\u2462"},{"id":"ref-for-clock\u2463"},{"id":"ref-for-clock\u2464"},{"id":"ref-for-clock\u2465"}],"title":"2.2. \n  Moments and Durations\n"},{"refs":[{"id":"ref-for-clock\u2466"}],"title":"4. \n  Time Origin\n"}],"url":"#clock"},
"coarsen-time": {"dfnID":"coarsen-time","dfnText":"coarsen time","external":false,"refSections":[{"refs":[{"id":"ref-for-coarsen-time"}],"title":"2.2. \n  Moments and Durations\n"},{"refs":[{"id":"ref-for-coarsen-time\u2460"},{"id":"ref-for-coarsen-time\u2461"},{"id":"ref-for-coarsen-time\u2462"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-coarsen-time\u2463"},{"id":"ref-for-coarsen-time\u2464"},{"id":"ref-for-coarsen-time\u2465"}],"title":"4. \n  Time Origin\n"},{"refs":[{"id":"ref-for-coarsen-time\u2466"}],"title":"9.1. \n  Clock resolution\n"}],"url":"#coarsen-time"},
"coarsened-shared-current-time": {"dfnID":"coarsened-shared-current-time","dfnText":"coarsened shared current time","external":false,"refSections":[],"url":"#coarsened-shared-current-time"},
"current-high-resolution-time": {"dfnID":"current-high-resolution-time","dfnText":"current high resolution time","external":false,"refSections":[{"refs":[{"id":"ref-for-current-high-resolution-time"}],"title":"7.1. \n  now() method\n"}],"url":"#current-high-resolution-time"},
"d4ec1548": {"dfnID":"d4ec1548","dfnText":"timeStamp","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-timestamp"}],"title":"3.1. \n  Examples\n"}],"url":"https://dom.spec.whatwg.org/#dom-event-timestamp"},
"d7384c6e": {"dfnID":"d7384c6e","dfnText":"tracking vector","external":true,"refSections":[{"refs":[{"id":"ref-for-tracking-vector"}],"title":"3. \n  Tools for Specification Authors\n"}],"url":"https://infra.spec.whatwg.org/#tracking-vector"},
"dc7feabb": {"dfnID":"dc7feabb","dfnText":"default toJSON steps","external":true,"refSections":[{"refs":[{"id":"ref-for-default-tojson-steps"}],"title":"7.3. \n  toJSON() method\n"}],"url":"https://webidl.spec.whatwg.org/#default-tojson-steps"},
"dfn-current-wall-time": {"dfnID":"dfn-current-wall-time","dfnText":"current coarsened wall\n  time","external":false,"refSections":[{"refs":[{"id":"ref-for-dfn-current-wall-time"}],"title":"3. \n  Tools for Specification Authors\n"}],"url":"#dfn-current-wall-time"},
"dfn-eso-current-wall-time": {"dfnID":"dfn-eso-current-wall-time","dfnText":"current\n  wall time","external":false,"refSections":[{"refs":[{"id":"ref-for-dfn-eso-current-wall-time"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-dfn-eso-current-wall-time\u2460"},{"id":"ref-for-dfn-eso-current-wall-time\u2461"}],"title":"3.1. \n  Examples\n"}],"url":"#dfn-eso-current-wall-time"},
"dom-performance-now": {"dfnID":"dom-performance-now","dfnText":"now","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-performance-now"}],"title":"1. \n  Introduction\n"},{"refs":[{"id":"ref-for-dom-performance-now\u2460"},{"id":"ref-for-dom-performance-now\u2461"}],"title":"7.1. \n  now() method\n"},{"refs":[{"id":"ref-for-dom-performance-now\u2462"}],"title":"9.2. \n  Clock drift\n"}],"url":"#dom-performance-now"},
"dom-performance-timeorigin": {"dfnID":"dom-performance-timeorigin","dfnText":"timeOrigin","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-performance-timeorigin"}],"title":"1. \n  Introduction\n"},{"refs":[{"id":"ref-for-dom-performance-timeorigin\u2460"}],"title":"1.2. \n  Examples\n"},{"refs":[{"id":"ref-for-dom-performance-timeorigin\u2461"}],"title":"7.2. \n  timeOrigin attribute\n"},{"refs":[{"id":"ref-for-dom-performance-timeorigin\u2462"}],"title":"9.2. \n  Clock drift\n"}],"url":"#dom-performance-timeorigin"},
"dom-performance-tojson": {"dfnID":"dom-performance-tojson","dfnText":"toJSON","external":false,"refSections":[],"url":"#dom-performance-tojson"},
"dom-windoworworkerglobalscope-performance": {"dfnID":"dom-windoworworkerglobalscope-performance","dfnText":"performance","external":false,"refSections":[],"url":"#dom-windoworworkerglobalscope-performance"},
"domhighrestimestamp": {"dfnID":"domhighrestimestamp","dfnText":"DOMHighResTimeStamp","external":false,"refSections":[],"url":"#domhighrestimestamp"},
"duration": {"dfnID":"duration","dfnText":"duration","external":false,"refSections":[{"refs":[{"id":"ref-for-duration"},{"id":"ref-for-duration\u2460"},{"id":"ref-for-duration\u2461"},{"id":"ref-for-duration\u2462"},{"id":"ref-for-duration\u2463"},{"id":"ref-for-duration\u2464"},{"id":"ref-for-duration\u2465"},{"id":"ref-for-duration\u2466"},{"id":"ref-for-duration\u2467"},{"id":"ref-for-duration\u2468"}],"title":"2.2. \n  Moments and Durations\n"},{"refs":[{"id":"ref-for-duration\u2460\u24ea"},{"id":"ref-for-duration\u2460\u2460"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-duration\u2460\u2461"},{"id":"ref-for-duration\u2460\u2462"},{"id":"ref-for-duration\u2460\u2463"}],"title":"4. \n  Time Origin\n"},{"refs":[{"id":"ref-for-duration\u2460\u2464"},{"id":"ref-for-duration\u2460\u2465"}],"title":"5. \n  The DOMHighResTimeStamp typedef\n"},{"refs":[{"id":"ref-for-duration\u2460\u2466"}],"title":"7.1. \n  now() method\n"},{"refs":[{"id":"ref-for-duration\u2460\u2467"}],"title":"7.2. \n  timeOrigin attribute\n"}],"url":"#duration"},
"duration-from": {"dfnID":"duration-from","dfnText":"duration from","external":false,"refSections":[{"refs":[{"id":"ref-for-duration-from"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-duration-from\u2460"},{"id":"ref-for-duration-from\u2461"}],"title":"4. \n  Time Origin\n"}],"url":"#duration-from"},
"e99bd18e": {"dfnID":"e99bd18e","dfnText":"relevant global object","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-relevant-global"}],"title":"7.1. \n  now() method\n"},{"refs":[{"id":"ref-for-concept-relevant-global\u2460"}],"title":"7.2. \n  timeOrigin attribute\n"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"},
"e9c58cef": {"dfnID":"e9c58cef","dfnText":"time origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-settings-object-time-origin"}],"title":"1.2. \n  Examples\n"},{"refs":[{"id":"ref-for-concept-settings-object-time-origin\u2460"},{"id":"ref-for-concept-settings-object-time-origin\u2461"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-concept-settings-object-time-origin\u2462"},{"id":"ref-for-concept-settings-object-time-origin\u2463"},{"id":"ref-for-concept-settings-object-time-origin\u2464"},{"id":"ref-for-concept-settings-object-time-origin\u2465"}],"title":"4. \n  Time Origin\n"},{"refs":[{"id":"ref-for-concept-settings-object-time-origin\u2466"}],"title":"5. \n  The DOMHighResTimeStamp typedef\n"},{"refs":[{"id":"ref-for-concept-settings-object-time-origin\u2467"},{"id":"ref-for-concept-settings-object-time-origin\u2468"}],"title":"7.1. \n  now() method\n"},{"refs":[{"id":"ref-for-concept-settings-object-time-origin\u2460\u24ea"}],"title":"7.2. \n  timeOrigin attribute\n"},{"refs":[{"id":"ref-for-concept-settings-object-time-origin\u2460\u2460"},{"id":"ref-for-concept-settings-object-time-origin\u2460\u2461"}],"title":"9.2. \n  Clock drift\n"},{"refs":[{"id":"ref-for-concept-settings-object-time-origin\u2460\u2462"}],"title":"10. \n  Privacy Considerations\n"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin"},
"efd1ec5d": {"dfnID":"efd1ec5d","dfnText":"object","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-object"}],"title":"7. \n  The Performance interface\n"}],"url":"https://webidl.spec.whatwg.org/#idl-object"},
"environment-settings-object-current-monotonic-time": {"dfnID":"environment-settings-object-current-monotonic-time","dfnText":"current monotonic time","external":false,"refSections":[{"refs":[{"id":"ref-for-environment-settings-object-current-monotonic-time"},{"id":"ref-for-environment-settings-object-current-monotonic-time\u2460"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-environment-settings-object-current-monotonic-time\u2461"},{"id":"ref-for-environment-settings-object-current-monotonic-time\u2462"}],"title":"3.1. \n  Examples\n"}],"url":"#environment-settings-object-current-monotonic-time"},
"environment-settings-object-current-relative-timestamp": {"dfnID":"environment-settings-object-current-relative-timestamp","dfnText":"current relative timestamp","external":false,"refSections":[{"refs":[{"id":"ref-for-environment-settings-object-current-relative-timestamp"}],"title":"3.1. \n  Examples\n"}],"url":"#environment-settings-object-current-relative-timestamp"},
"epochtimestamp": {"dfnID":"epochtimestamp","dfnText":"EpochTimeStamp","external":false,"refSections":[],"url":"#epochtimestamp"},
"estimated-monotonic-time-of-the-unix-epoch": {"dfnID":"estimated-monotonic-time-of-the-unix-epoch","dfnText":"estimated monotonic time of the Unix\n  epoch","external":false,"refSections":[{"refs":[{"id":"ref-for-estimated-monotonic-time-of-the-unix-epoch"}],"title":"2.1. \n  Clocks\n"},{"refs":[{"id":"ref-for-estimated-monotonic-time-of-the-unix-epoch\u2460"},{"id":"ref-for-estimated-monotonic-time-of-the-unix-epoch\u2461"}],"title":"4. \n  Time Origin\n"}],"url":"#estimated-monotonic-time-of-the-unix-epoch"},
"f14b47b8": {"dfnID":"f14b47b8","dfnText":"unsigned long long","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-unsigned-long-long"}],"title":"6. \n  The EpochTimeStamp typedef\n"}],"url":"https://webidl.spec.whatwg.org/#idl-unsigned-long-long"},
"f4531911": {"dfnID":"f4531911","dfnText":"Default","external":true,"refSections":[{"refs":[{"id":"ref-for-Default"}],"title":"7. \n  The Performance interface\n"}],"url":"https://webidl.spec.whatwg.org/#Default"},
"get-time-origin-timestamp": {"dfnID":"get-time-origin-timestamp","dfnText":"get time origin timestamp","external":false,"refSections":[{"refs":[{"id":"ref-for-get-time-origin-timestamp"}],"title":"4. \n  Time Origin\n"},{"refs":[{"id":"ref-for-get-time-origin-timestamp\u2460"}],"title":"7.2. \n  timeOrigin attribute\n"}],"url":"#get-time-origin-timestamp"},
"implicitly-convert-a-duration-to-a-timestamp": {"dfnID":"implicitly-convert-a-duration-to-a-timestamp","dfnText":"implicitly convert a duration to a timestamp","external":false,"refSections":[{"refs":[{"id":"ref-for-implicitly-convert-a-duration-to-a-timestamp"}],"title":"3. \n  Tools for Specification Authors\n"}],"url":"#implicitly-convert-a-duration-to-a-timestamp"},
"moment": {"dfnID":"moment","dfnText":"coarsened moments","external":false,"refSections":[{"refs":[{"id":"ref-for-moment"},{"id":"ref-for-moment\u2460"},{"id":"ref-for-moment\u2461"},{"id":"ref-for-moment\u2462"},{"id":"ref-for-moment\u2463"},{"id":"ref-for-moment\u2464"},{"id":"ref-for-moment\u2465"},{"id":"ref-for-moment\u2466"},{"id":"ref-for-moment\u2467"}],"title":"2.2. \n  Moments and Durations\n"},{"refs":[{"id":"ref-for-moment\u2468"},{"id":"ref-for-moment\u2460\u24ea"},{"id":"ref-for-moment\u2460\u2460"},{"id":"ref-for-moment\u2460\u2461"},{"id":"ref-for-moment\u2460\u2462"},{"id":"ref-for-moment\u2460\u2463"},{"id":"ref-for-moment\u2460\u2464"},{"id":"ref-for-moment\u2460\u2465"},{"id":"ref-for-moment\u2460\u2466"},{"id":"ref-for-moment\u2460\u2467"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-moment\u2460\u2468"},{"id":"ref-for-moment\u2461\u24ea"},{"id":"ref-for-moment\u2461\u2460"},{"id":"ref-for-moment\u2461\u2461"},{"id":"ref-for-moment\u2461\u2462"},{"id":"ref-for-moment\u2461\u2463"}],"title":"4. \n  Time Origin\n"},{"refs":[{"id":"ref-for-moment\u2461\u2464"},{"id":"ref-for-moment\u2461\u2465"},{"id":"ref-for-moment\u2461\u2466"},{"id":"ref-for-moment\u2461\u2467"}],"title":"5. \n  The DOMHighResTimeStamp typedef\n"},{"refs":[{"id":"ref-for-moment\u2461\u2468"}],"title":"6. \n  The EpochTimeStamp typedef\n"}],"url":"#moment"},
"monotonic-clock": {"dfnID":"monotonic-clock","dfnText":"monotonic clock","external":false,"refSections":[{"refs":[{"id":"ref-for-monotonic-clock"},{"id":"ref-for-monotonic-clock\u2460"}],"title":"2.1. \n  Clocks\n"},{"refs":[{"id":"ref-for-monotonic-clock\u2461"},{"id":"ref-for-monotonic-clock\u2462"},{"id":"ref-for-monotonic-clock\u2463"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-monotonic-clock\u2464"},{"id":"ref-for-monotonic-clock\u2465"},{"id":"ref-for-monotonic-clock\u2466"},{"id":"ref-for-monotonic-clock\u2467"},{"id":"ref-for-monotonic-clock\u2468"},{"id":"ref-for-monotonic-clock\u2460\u24ea"}],"title":"4. \n  Time Origin\n"},{"refs":[{"id":"ref-for-monotonic-clock\u2460\u2460"}],"title":"7.1. \n  now() method\n"},{"refs":[{"id":"ref-for-monotonic-clock\u2460\u2461"}],"title":"7.2. \n  timeOrigin attribute\n"},{"refs":[{"id":"ref-for-monotonic-clock\u2460\u2462"},{"id":"ref-for-monotonic-clock\u2460\u2463"},{"id":"ref-for-monotonic-clock\u2460\u2464"},{"id":"ref-for-monotonic-clock\u2460\u2465"}],"title":"9.2. \n  Clock drift\n"}],"url":"#monotonic-clock"},
"monotonic-clock-unsafe-current-time": {"dfnID":"monotonic-clock-unsafe-current-time","dfnText":"unsafe current time","external":false,"refSections":[{"refs":[{"id":"ref-for-monotonic-clock-unsafe-current-time"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-monotonic-clock-unsafe-current-time\u2460"},{"id":"ref-for-monotonic-clock-unsafe-current-time\u2461"}],"title":"4. \n  Time Origin\n"}],"url":"#monotonic-clock-unsafe-current-time"},
"now": {"dfnID":"now","dfnText":"now()","external":false,"refSections":[],"url":"#now"},
"performance": {"dfnID":"performance","dfnText":"Performance","external":false,"refSections":[{"refs":[{"id":"ref-for-performance"},{"id":"ref-for-performance\u2460"},{"id":"ref-for-performance\u2461"}],"title":"1. \n  Introduction\n"},{"refs":[{"id":"ref-for-performance\u2462"}],"title":"1.2. \n  Examples\n"},{"refs":[{"id":"ref-for-performance\u2463"}],"title":"7.1. \n  now() method\n"},{"refs":[{"id":"ref-for-performance\u2464"}],"title":"7.2. \n  timeOrigin attribute\n"},{"refs":[{"id":"ref-for-performance\u2465"}],"title":"8.1. \n  The performance attribute\n"}],"url":"#performance"},
"performance-performance": {"dfnID":"performance-performance","dfnText":"Performance","external":false,"refSections":[],"url":"#performance-performance"},
"relative-high-resolution-coarse-time": {"dfnID":"relative-high-resolution-coarse-time","dfnText":"relative high resolution coarse time","external":false,"refSections":[{"refs":[{"id":"ref-for-relative-high-resolution-coarse-time"}],"title":"4. \n  Time Origin\n"}],"url":"#relative-high-resolution-coarse-time"},
"relative-high-resolution-time": {"dfnID":"relative-high-resolution-time","dfnText":"relative high resolution time","external":false,"refSections":[{"refs":[{"id":"ref-for-relative-high-resolution-time"}],"title":"4. \n  Time Origin\n"}],"url":"#relative-high-resolution-time"},
"the-performance-attr": {"dfnID":"the-performance-attr","dfnText":"performance","external":false,"refSections":[],"url":"#the-performance-attr"},
"timeorigin": {"dfnID":"timeorigin","dfnText":"timeOrigin","external":false,"refSections":[],"url":"#timeorigin"},
"tojson": {"dfnID":"tojson","dfnText":"toJSON()","external":false,"refSections":[],"url":"#tojson"},
"typedefdef-domhighrestimestamp": {"dfnID":"typedefdef-domhighrestimestamp","dfnText":"DOMHighResTimeStamp","external":false,"refSections":[{"refs":[{"id":"ref-for-typedefdef-domhighrestimestamp"}],"title":"1. \n  Introduction\n"},{"refs":[{"id":"ref-for-typedefdef-domhighrestimestamp\u2460"}],"title":"1.2. \n  Examples\n"},{"refs":[{"id":"ref-for-typedefdef-domhighrestimestamp\u2461"}],"title":"2.2. \n  Moments and Durations\n"},{"refs":[{"id":"ref-for-typedefdef-domhighrestimestamp\u2462"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-typedefdef-domhighrestimestamp\u2463"},{"id":"ref-for-typedefdef-domhighrestimestamp\u2464"},{"id":"ref-for-typedefdef-domhighrestimestamp\u2465"}],"title":"5. \n  The DOMHighResTimeStamp typedef\n"},{"refs":[{"id":"ref-for-typedefdef-domhighrestimestamp\u2466"}],"title":"6. \n  The EpochTimeStamp typedef\n"},{"refs":[{"id":"ref-for-typedefdef-domhighrestimestamp\u2467"},{"id":"ref-for-typedefdef-domhighrestimestamp\u2468"}],"title":"7. \n  The Performance interface\n"},{"refs":[{"id":"ref-for-typedefdef-domhighrestimestamp\u2460\u24ea"}],"title":"9.1. \n  Clock resolution\n"}],"url":"#typedefdef-domhighrestimestamp"},
"typedefdef-epochtimestamp": {"dfnID":"typedefdef-epochtimestamp","dfnText":"EpochTimeStamp","external":false,"refSections":[{"refs":[{"id":"ref-for-typedefdef-epochtimestamp"}],"title":"6. \n  The EpochTimeStamp typedef\n"},{"refs":[{"id":"ref-for-typedefdef-epochtimestamp\u2460"}],"title":"9.1. \n  Clock resolution\n"}],"url":"#typedefdef-epochtimestamp"},
"unix-epoch": {"dfnID":"unix-epoch","dfnText":"Unix epoch","external":false,"refSections":[{"refs":[{"id":"ref-for-unix-epoch"},{"id":"ref-for-unix-epoch\u2460"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-unix-epoch\u2461"},{"id":"ref-for-unix-epoch\u2462"}],"title":"4. \n  Time Origin\n"},{"refs":[{"id":"ref-for-unix-epoch\u2463"},{"id":"ref-for-unix-epoch\u2464"}],"title":"5. \n  The DOMHighResTimeStamp typedef\n"},{"refs":[{"id":"ref-for-unix-epoch\u2465"}],"title":"6. \n  The EpochTimeStamp typedef\n"}],"url":"#unix-epoch"},
"unsafe-current-time": {"dfnID":"unsafe-current-time","dfnText":"unsafe current time","external":false,"refSections":[{"refs":[{"id":"ref-for-unsafe-current-time"}],"title":"2.2. \n  Moments and Durations\n"}],"url":"#unsafe-current-time"},
"unsafe-moment": {"dfnID":"unsafe-moment","dfnText":"unsafe\n  moment","external":false,"refSections":[{"refs":[{"id":"ref-for-unsafe-moment"},{"id":"ref-for-unsafe-moment\u2460"},{"id":"ref-for-unsafe-moment\u2461"},{"id":"ref-for-unsafe-moment\u2462"}],"title":"2.2. \n  Moments and Durations\n"},{"refs":[{"id":"ref-for-unsafe-moment\u2463"},{"id":"ref-for-unsafe-moment\u2464"}],"title":"4. \n  Time Origin\n"}],"url":"#unsafe-moment"},
"unsafe-shared-current-time": {"dfnID":"unsafe-shared-current-time","dfnText":"unsafe shared current time","external":false,"refSections":[{"refs":[{"id":"ref-for-unsafe-shared-current-time"},{"id":"ref-for-unsafe-shared-current-time\u2460"}],"title":"4. \n  Time Origin\n"}],"url":"#unsafe-shared-current-time"},
"wall-clock": {"dfnID":"wall-clock","dfnText":"wall clock","external":false,"refSections":[{"refs":[{"id":"ref-for-wall-clock"},{"id":"ref-for-wall-clock\u2460"}],"title":"2.1. \n  Clocks\n"},{"refs":[{"id":"ref-for-wall-clock\u2461"},{"id":"ref-for-wall-clock\u2462"},{"id":"ref-for-wall-clock\u2463"},{"id":"ref-for-wall-clock\u2464"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-wall-clock\u2465"},{"id":"ref-for-wall-clock\u2466"}],"title":"4. \n  Time Origin\n"},{"refs":[{"id":"ref-for-wall-clock\u2467"}],"title":"6. \n  The EpochTimeStamp typedef\n"}],"url":"#wall-clock"},
"wall-clock-unsafe-current-time": {"dfnID":"wall-clock-unsafe-current-time","dfnText":"unsafe current time","external":false,"refSections":[{"refs":[{"id":"ref-for-wall-clock-unsafe-current-time"}],"title":"2.1. \n  Clocks\n"},{"refs":[{"id":"ref-for-wall-clock-unsafe-current-time\u2460"},{"id":"ref-for-wall-clock-unsafe-current-time\u2461"}],"title":"3. \n  Tools for Specification Authors\n"},{"refs":[{"id":"ref-for-wall-clock-unsafe-current-time\u2462"}],"title":"4. \n  Time Origin\n"}],"url":"#wall-clock-unsafe-current-time"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#clock": {"displayText":"clock","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"clock","type":"dfn","url":"#clock"},
"#coarsen-time": {"displayText":"coarsen time","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"coarsen time","type":"dfn","url":"#coarsen-time"},
"#current-high-resolution-time": {"displayText":"current high resolution time","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"current high resolution time","type":"dfn","url":"#current-high-resolution-time"},
"#dfn-current-wall-time": {"displayText":"current coarsened wall time","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"current coarsened wall time","type":"dfn","url":"#dfn-current-wall-time"},
"#dfn-eso-current-wall-time": {"displayText":"current wall time","export":true,"for_":["environment settings object"],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"current wall time","type":"dfn","url":"#dfn-eso-current-wall-time"},
"#dom-performance-now": {"displayText":"now()","export":true,"for_":["Performance"],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"now()","type":"method","url":"#dom-performance-now"},
"#dom-performance-timeorigin": {"displayText":"timeOrigin","export":true,"for_":["Performance"],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"timeOrigin","type":"attribute","url":"#dom-performance-timeorigin"},
"#duration": {"displayText":"duration","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"duration","type":"dfn","url":"#duration"},
"#duration-from": {"displayText":"duration from","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"duration from","type":"dfn","url":"#duration-from"},
"#environment-settings-object-current-monotonic-time": {"displayText":"current monotonic time","export":true,"for_":["environment settings object"],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"current monotonic time","type":"dfn","url":"#environment-settings-object-current-monotonic-time"},
"#environment-settings-object-current-relative-timestamp": {"displayText":"current relative timestamp","export":true,"for_":["environment settings object"],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"current relative timestamp","type":"dfn","url":"#environment-settings-object-current-relative-timestamp"},
"#estimated-monotonic-time-of-the-unix-epoch": {"displayText":"estimated monotonic time of the unix epoch","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"estimated monotonic time of the unix epoch","type":"dfn","url":"#estimated-monotonic-time-of-the-unix-epoch"},
"#get-time-origin-timestamp": {"displayText":"get time origin timestamp","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"get time origin timestamp","type":"dfn","url":"#get-time-origin-timestamp"},
"#implicitly-convert-a-duration-to-a-timestamp": {"displayText":"implicitly convert a duration to a timestamp","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"implicitly convert a duration to a timestamp","type":"dfn","url":"#implicitly-convert-a-duration-to-a-timestamp"},
"#moment": {"displayText":"moment","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"moment","type":"dfn","url":"#moment"},
"#monotonic-clock": {"displayText":"monotonic clock","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"monotonic clock","type":"dfn","url":"#monotonic-clock"},
"#monotonic-clock-unsafe-current-time": {"displayText":"unsafe current time","export":true,"for_":["monotonic clock"],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"unsafe current time","type":"dfn","url":"#monotonic-clock-unsafe-current-time"},
"#performance": {"displayText":"Performance","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"Performance","type":"interface","url":"#performance"},
"#relative-high-resolution-coarse-time": {"displayText":"relative high resolution coarse time","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"relative high resolution coarse time","type":"dfn","url":"#relative-high-resolution-coarse-time"},
"#relative-high-resolution-time": {"displayText":"relative high resolution time","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"relative high resolution time","type":"dfn","url":"#relative-high-resolution-time"},
"#typedefdef-domhighrestimestamp": {"displayText":"DOMHighResTimeStamp","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"DOMHighResTimeStamp","type":"typedef","url":"#typedefdef-domhighrestimestamp"},
"#typedefdef-epochtimestamp": {"displayText":"EpochTimeStamp","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"EpochTimeStamp","type":"typedef","url":"#typedefdef-epochtimestamp"},
"#unix-epoch": {"displayText":"unix epoch","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"unix epoch","type":"dfn","url":"#unix-epoch"},
"#unsafe-moment": {"displayText":"unsafe moment","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"unsafe moment","type":"dfn","url":"#unsafe-moment"},
"#unsafe-shared-current-time": {"displayText":"unsafe shared current time","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"unsafe shared current time","type":"dfn","url":"#unsafe-shared-current-time"},
"#wall-clock": {"displayText":"wall clock","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"wall clock","type":"dfn","url":"#wall-clock"},
"#wall-clock-unsafe-current-time": {"displayText":"unsafe current time","export":true,"for_":["wall clock"],"level":"","normative":true,"shortname":"hr-time-3","spec":"hr-time-3","status":"local","text":"unsafe current time","type":"dfn","url":"#wall-clock-unsafe-current-time"},
"https://dom.spec.whatwg.org/#document": {"displayText":"Document","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"Document","type":"interface","url":"https://dom.spec.whatwg.org/#document"},
"https://dom.spec.whatwg.org/#dom-event-timestamp": {"displayText":"timeStamp","export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"timeStamp","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-timestamp"},
"https://dom.spec.whatwg.org/#eventtarget": {"displayText":"EventTarget","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"EventTarget","type":"interface","url":"https://dom.spec.whatwg.org/#eventtarget"},
"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window": {"displayText":"Window","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"Window","type":"interface","url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"},
"https://html.spec.whatwg.org/multipage/web-messaging.html#broadcastchannel": {"displayText":"BroadcastChannel","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"BroadcastChannel","type":"interface","url":"https://html.spec.whatwg.org/multipage/web-messaging.html#broadcastchannel"},
"https://html.spec.whatwg.org/multipage/web-messaging.html#dom-window-postmessage-options": {"displayText":"postMessage(message, options)","export":true,"for_":["Window"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"postMessage(message, options)","type":"method","url":"https://html.spec.whatwg.org/multipage/web-messaging.html#dom-window-postmessage-options"},
"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global": {"displayText":"relevant global object","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"relevant global object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"},
"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability": {"displayText":"cross-origin isolated capability","export":true,"for_":["environment settings object"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"cross-origin isolated capability","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-cross-origin-isolated-capability"},
"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin": {"displayText":"time origin","export":true,"for_":["environment settings object"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"time origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-time-origin"},
"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object": {"displayText":"environment settings object","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"environment settings object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"},
"https://html.spec.whatwg.org/multipage/webappapis.html#global-object": {"displayText":"global object","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"global object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#global-object"},
"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object": {"displayText":"relevant settings object","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"relevant settings object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"},
"https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope": {"displayText":"WindowOrWorkerGlobalScope","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"WindowOrWorkerGlobalScope","type":"interface","url":"https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope"},
"https://html.spec.whatwg.org/multipage/workers.html#sharedworker": {"displayText":"SharedWorker","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"SharedWorker","type":"interface","url":"https://html.spec.whatwg.org/multipage/workers.html#sharedworker"},
"https://html.spec.whatwg.org/multipage/workers.html#worker": {"displayText":"Worker","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"Worker","type":"interface","url":"https://html.spec.whatwg.org/multipage/workers.html#worker"},
"https://infra.spec.whatwg.org/#implementation-defined": {"displayText":"implementation-defined","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"implementation-defined","type":"dfn","url":"https://infra.spec.whatwg.org/#implementation-defined"},
"https://infra.spec.whatwg.org/#tracking-vector": {"displayText":"tracking vector","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"tracking vector","type":"dfn","url":"https://infra.spec.whatwg.org/#tracking-vector"},
"https://infra.spec.whatwg.org/#user-agent": {"displayText":"user agent","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"user agent","type":"dfn","url":"https://infra.spec.whatwg.org/#user-agent"},
"https://tc39.es/ecma262/multipage/numbers-and-dates.html#sec-date-objects": {"displayText":"Date","export":true,"for_":[],"level":"1","normative":true,"shortname":"ecmascript","spec":"ecmascript","status":"current","text":"Date","type":"interface","url":"https://tc39.es/ecma262/multipage/numbers-and-dates.html#sec-date-objects"},
"https://w3c.github.io/ServiceWorker/#serviceworker": {"displayText":"ServiceWorker","export":true,"for_":[],"level":"1","normative":true,"shortname":"service-workers","spec":"service-workers","status":"current","text":"ServiceWorker","type":"interface","url":"https://w3c.github.io/ServiceWorker/#serviceworker"},
"https://w3c.github.io/hr-time/#dfn-moment": {"displayText":"coarsened moments","export":true,"for_":[],"level":"3","normative":true,"shortname":"hr-time","spec":"hr-time-3","status":"current","text":"coarsened moments","type":"dfn","url":"https://w3c.github.io/hr-time/#dfn-moment"},
"https://webidl.spec.whatwg.org/#Default": {"displayText":"Default","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"Default","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#Default"},
"https://webidl.spec.whatwg.org/#Exposed": {"displayText":"Exposed","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"Exposed","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#Exposed"},
"https://webidl.spec.whatwg.org/#Replaceable": {"displayText":"Replaceable","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"Replaceable","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#Replaceable"},
"https://webidl.spec.whatwg.org/#default-tojson-steps": {"displayText":"default toJSON steps","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"default tojson steps","type":"dfn","url":"https://webidl.spec.whatwg.org/#default-tojson-steps"},
"https://webidl.spec.whatwg.org/#idl-double": {"displayText":"double","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"double","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-double"},
"https://webidl.spec.whatwg.org/#idl-object": {"displayText":"object","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"object","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-object"},
"https://webidl.spec.whatwg.org/#idl-unsigned-long-long": {"displayText":"unsigned long long","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"unsigned long long","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-unsigned-long-long"},
"https://webidl.spec.whatwg.org/#this": {"displayText":"this","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"this","type":"dfn","url":"https://webidl.spec.whatwg.org/#this"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
        // Give the original term if it's being displayed in a different way.
        // But allow casing differences, they're insignificant.
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.displayText)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const refHintKey = link.getAttribute("data-refhint-key");
    let key = url;
    if(refHintKey) {
        key = refHintKey + "_" + url;
    }
    const ref = refsData[key];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>
<script>/* Boilerplate: script-var-click-highlighting */
"use strict";
{
/*
Color-choosing design:

* Colors are ordered by goodness.
* On clicking a var, give it the earliest color
    with the lowest usage in the algorithm.
* On re-clicking, re-use the var's most recent color
    if that's not currently being used elsewhere.
*/

const COLOR_COUNT = 7;

document.addEventListener("click", e=>{
    if(e.target.nodeName == "VAR") {
        highlightSameAlgoVars(e.target);
    }
});

function highlightSameAlgoVars(v) {
    // Find the algorithm container.
    let algoContainer = findAlgoContainer(v);

    // Not highlighting document-global vars,
    // too likely to be unrelated.
    if(algoContainer == null) return;

    const varName = nameFromVar(v);
    if(!v.hasAttribute("data-var-color")) {
        const newColor = chooseHighlightColor(algoContainer, v);
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.setAttribute("data-var-color", newColor);
                el.setAttribute("data-var-last-color", newColor);
            }
        }
    } else {
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.removeAttribute("data-var-color");
            }
        }
    }
}
function findAlgoContainer(el) {
    while(el != document.body) {
        if(el.hasAttribute("data-algorithm")) return el;
        el = el.parentNode;
    }
    return null;
}
function nameFromVar(el) {
    return el.textContent.replace(/(\s|\xa0)+/g, " ").trim();
}
function colorCountsFromContainer(container) {
    const namesFromColor = Array.from({length:COLOR_COUNT}, x=>new Set());
    for(let v of container.querySelectorAll("var[data-var-color]")) {
        let color = +v.getAttribute("data-var-color");
        namesFromColor[color].add(nameFromVar(v));
    }

    return namesFromColor.map(x=>x.size);
}
function leastUsedColor(colors) {
    // Find the earliest color with the lowest count.
    let minCount = Infinity;
    let minColor = null;
    for(var i = 0; i < colors.length; i++) {
        if(colors[i] < minCount) {
            minColor = i;
            minCount = colors[i];
        }
    }
    return minColor;
}
function chooseHighlightColor(container, v) {
    const colorCounts = colorCountsFromContainer(container);
    if(v.hasAttribute("data-var-last-color")) {
        let color = +v.getAttribute("data-var-last-color");
        if(colorCounts[color] == 0) return color;
    }
    return leastUsedColor(colorCounts);
}
}
</script>